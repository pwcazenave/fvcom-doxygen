<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.11"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>FVCOM: uk-fvcom/FVCOM_source/mod_ice.F Source File</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">FVCOM 3.2.2</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_20654a8fdd457401057e8f0d258e98db.html">uk-fvcom</a></li><li class="navelem"><a class="el" href="dir_2508a591beed8514b3761fd5dec36e7c.html">FVCOM_source</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mod_ice.F</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mod__ice_8F.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!/===========================================================================/</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">! Copyright (c) 2007, The University of Massachusetts Dartmouth </span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">! Produced at the School of Marine Science &amp; Technology </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">! Marine Ecosystem Dynamics Modeling group</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">! All rights reserved.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">! FVCOM has been developed by the joint UMASSD-WHOI research team. For </span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">! details of authorship and attribution of credit please see the FVCOM</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">! technical manual or contact the MEDM group.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">! </span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">! This file is part of FVCOM. For details, see http://fvcom.smast.umassd.edu </span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">! The full copyright notice is contained in the file COPYRIGHT located in the </span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">! root directory of the FVCOM code. This original header must be maintained</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">! in all distributed versions.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">! THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; </span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">! AND ANY EXPRESS OR  IMPLIED WARRANTIES, INCLUDING,  BUT NOT  LIMITED TO,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">! THE IMPLIED WARRANTIES OF MERCHANTABILITY AND  FITNESS FOR A PARTICULAR</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">! PURPOSE ARE DISCLAIMED.  </span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!/---------------------------------------------------------------------------/</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">! CVS VERSION INFORMATION</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">! $Id$</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">! $Name$</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">! $Revision$</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">!/===========================================================================/</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">! VERSIONS.  Finite volume </span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">! Comments:     Sea Ice Module </span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">! connect the thermodynamic module(CICE) and Finite-volume dynamics module(EVP)</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">! Current FVCOM dependency</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">!   archive.F:   - calls archive_ice</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">!   mod_ncdio.F: - netcdf output includes some variables</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">!   us_fvcom.F:  - main calls ice setup </span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">!=======================================================================</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="namespacemod__ice.html">   42</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacemod__ice.html">mod_ice</a> </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#  if defined (ICE)</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor"></span>   <span class="keywordtype">USE </span><a class="code" href="namespaceall__vars.html">all_vars</a></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="keywordtype">USE </span><a class="code" href="namespacemod__par.html">mod_par</a></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="keywordtype">USE </span><a class="code" href="namespacemod__utils.html">mod_utils</a></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacemod__ice2d.html">mod_ice2d</a></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">!====================================================================</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">!--------------------------------------------------------------</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">!   for cice code</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">! !USES:</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__model__size.html">ice_model_size</a></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__albedo.html">ice_albedo</a></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__calendar.html">ice_calendar</a></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">!      use ice_coupling</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">!      use ice_diagnostics</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__domain.html">ice_domain</a></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">!      use ice_dyn_evp</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__fileunits.html">ice_fileunits</a></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__flux__in.html">ice_flux_in</a></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__grid.html">ice_grid</a></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">!     use ice_history</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__init.html">ice_init</a></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__itd.html">ice_itd</a></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__itd__linear.html">ice_itd_linear</a></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__kinds__mod.html">ice_kinds_mod</a></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__mechred.html">ice_mechred</a></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__ocean.html">ice_ocean</a></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__atmo.html">ice_atmo</a></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__scaling.html">ice_scaling</a></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__therm__vertical.html">ice_therm_vertical</a></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__therm__itd.html">ice_therm_itd</a></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__work.html">ice_work</a></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">!====================================================================</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">CONTAINS</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">!===============================================================================|</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">    SUBROUTINE </span>ice_init_0</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">!==============================================================</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">integer</span> :: i,j,k</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">!--------------------------------------------------------------</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">!   for cice code</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">! !USES:</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">!=======================================================================</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">!=======================================================================|</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">!      ice_domain_def      </span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">IF</span>(<a class="code" href="namespacemod__utils.html#af4d60bccc1216e0c740fcefc0674ef9b">dbg_set</a>(<a class="code" href="namespacemod__utils.html#a60e94d6abe4ceab6a20f4e569a826bea">dbg_sbr</a>)) <span class="keyword">write</span>(ipt,*)<span class="stringliteral">&#39;START ice_init_0&#39;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;       </div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;       <a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a> = 1  <span class="comment">! beg index of actual physical subdomain</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;       <a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a> = m <span class="comment">!T  ! end index</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;       <a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a> =  m <span class="comment">!T !, &amp;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;       <a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a> = 1   <span class="comment">! beg index of actual physical subdomain</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;       <a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a> =1 </div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;       <a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>= 1</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;       <span class="keyword">allocate</span>(<a class="code" href="namespaceice__domain.html#a9a7d467657702c4668fc81966246b1da">index_global</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>), <a class="code" href="namespaceice__domain.html#ad18f5f3372d9364a7ed17827dc9d0bdd">rndex_global</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">!       ice_work     </span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keyword">allocate</span>( <a class="code" href="namespaceice__work.html#aad897aa7c6c5fc4bc998a5dbaf71baa0">work_l1</a>(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keyword">allocate</span>( <a class="code" href="namespaceice__work.html#a6dbc3fc4e0de1fec11e796800ad56a08">work_l2</a>(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keyword">allocate</span>( <a class="code" href="namespaceice__work.html#a332295fcdafb79aaea5e8cfc26213d5e">worka</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">allocate</span>( <a class="code" href="namespaceice__work.html#a882c804b3549d9c719d525ff826ba621">workb</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">!      ice_state_def</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keyword">allocate</span>(aice(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))  ;aice=zero  <span class="comment">! concentration of ice </span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keyword">allocate</span>(vice(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))  ;vice=zero  <span class="comment">! volume per unit area of ice          (m)</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keyword">allocate</span>(vsno(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))  ;vsno=zero  <span class="comment">! volume per unit area of snow         (m)</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keyword">allocate</span>(tsfc(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))  ;tsfc=zero  <span class="comment">! temperature of ice/snow top surface  (C)</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keyword">allocate</span>(eice(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))  ;eice=zero  <span class="comment">! energy of melt. of ice           (J/m^2)</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keyword">allocate</span>(esno(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))  ;esno=zero  <span class="comment">! energy of melt. of snow layer    (J/m^2)</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keyword">allocate</span>(tmass(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>)) ;tmass=zero <span class="comment">! total mass of ice and snow</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keyword">allocate</span>(aice_init(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>));aice_init=zero <span class="comment">! concentration of ice at beginning of dt (for diagnostics)</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">! state of the ice for each category</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keyword">allocate</span>(aicen(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>)) ;aicen=zero   <span class="comment">! concentration of ice </span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keyword">allocate</span>(vicen(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>)) ;vicen=zero   <span class="comment">! volume per unit area of ice          (m)</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keyword">allocate</span>(vsnon(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>)) ;vsnon=zero   <span class="comment">! volume per unit area of snow         (m)</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keyword">allocate</span>(tsfcn(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>)) ;tsfcn=zero   <span class="comment">! temperature of ice/snow top surface  (C)</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keyword">allocate</span>(esnon(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>)) ;esnon=zero   <span class="comment">! energy of melt. of snow layer    (J/m^2)</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keyword">allocate</span>(aice0(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))       ;aice0=c1i  <span class="comment">! concentration of open water</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keyword">allocate</span>(eicen(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>,<a class="code" href="namespaceice__model__size.html#aad5690a90b6f7ad823dba09d293ca892">ntilay</a>));eicen=zero  <span class="comment">! energy of melting for</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="comment">! other variables closely related to the state of the ice</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="comment">!allocate(uvel(imt_local,jmt_local))      ;uvel=ZERO! x-component of velocity (m/s)</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="comment">!allocate(vvel(imt_local,jmt_local))      ;vvel=ZERO! y-component of velocity (m/s)</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keyword">allocate</span>(strength(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))  ;strength=zero   <span class="comment">! ice strength (N/m)</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">!=======================================================================</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">!      subroutine ice_albedo_def</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__albedo.html#a4d6a16f09a94a469c8770621857cde64">alvdrn</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>)) ;<a class="code" href="namespaceice__albedo.html#a4d6a16f09a94a469c8770621857cde64">alvdrn</a>=zero <span class="comment">! visible, direct   (fraction)</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__albedo.html#ad9b38d68b853035f07dc72db82e5625d">alidrn</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>)) ;<a class="code" href="namespaceice__albedo.html#ad9b38d68b853035f07dc72db82e5625d">alidrn</a>=zero <span class="comment">! near-ir, direct   (fraction)</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__albedo.html#a6c30720dc5655cb2a4e96be48d9477ce">alvdfn</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>)) ;<a class="code" href="namespaceice__albedo.html#a6c30720dc5655cb2a4e96be48d9477ce">alvdfn</a>=zero <span class="comment">! visible, diffuse  (fraction)</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__albedo.html#ad45ba52937dca1be56bd7f9fed1d4644">alidfn</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>)) ;<a class="code" href="namespaceice__albedo.html#ad45ba52937dca1be56bd7f9fed1d4644">alidfn</a>=zero <span class="comment">! near-ir, diffuse  (fraction)</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="comment">! albedos aggregated over categories</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__albedo.html#adb52e20b41821d68863101b9d8b68c73">alvdr</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) ;<a class="code" href="namespaceice__albedo.html#adb52e20b41821d68863101b9d8b68c73">alvdr</a>=zero  <span class="comment">! visible, direct   (fraction)</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__albedo.html#a4995ff7773a3e9f9a4d7ce3b4f490eca">alidr</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) ;<a class="code" href="namespaceice__albedo.html#a4995ff7773a3e9f9a4d7ce3b4f490eca">alidr</a>=zero <span class="comment">! near-ir, direct   (fraction)</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__albedo.html#a9ddfa8d4d70600cf1a99d17be4e3254f">alvdf</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) ;<a class="code" href="namespaceice__albedo.html#a9ddfa8d4d70600cf1a99d17be4e3254f">alvdf</a>=zero <span class="comment">! visible, diffuse  (fraction)</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__albedo.html#a38b8c8014dac676816f21a64874ea928">alidf</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) ;<a class="code" href="namespaceice__albedo.html#a38b8c8014dac676816f21a64874ea928">alidf</a>=zero <span class="comment">! near-ir, diffuse  (fraction)</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">!=======================================================================</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">!      subroutine ice_flux_def</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;     <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="comment">! Dynamics component</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">!   Dynamic component use FVCOM code</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (ilo:ihi,jlo:jhi)  :: &amp;</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;       <span class="comment">! in from ocean</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">!       allocate(ss_tltx(ilo:ihi,jlo:jhi))    ;ss_tltx=ZERO   ! sea surface slope, x-direction (m/m)</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">!       allocate(ss_tlty(ilo:ihi,jlo:jhi))    ;ss_tlty=ZERO   ! sea surface slope, y-direction</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">!       allocate(uocn   (ilo:ihi,jlo:jhi))    ;uocn   =ZERO   ! ocean current, x-direction (m/s)</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">!       allocate(vocn   (ilo:ihi,jlo:jhi))    ;vocn   =ZERO   ! ocean current, y-direction (m/s)</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;       <span class="comment">! out to atmosphere</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;       <span class="keyword">allocate</span>(strairxt(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;strairxt=zero <span class="comment">! stress on ice by air, x-direction</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;       <span class="keyword">allocate</span>(strairyt(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;strairyt=zero <span class="comment">! stress on ice by air, y-direction</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                     </div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;       <span class="comment">! out to ocean          T-cell (kg/m s^2)</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;       <span class="keyword">allocate</span>(strocnxt(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;strocnxt=zero <span class="comment">! ice-ocean stress, x-direction</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;       <span class="keyword">allocate</span>(strocnyt(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;strocnyt=zero <span class="comment">! ice-ocean stress, y-direction</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;       <span class="comment">! diagnostic</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;       <span class="keyword">allocate</span>(daidtd(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;daidtd=zero <span class="comment">! ice area tendency due to transport   (s^-1)</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;       <span class="keyword">allocate</span>(dvidtd(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;dvidtd=zero <span class="comment">! ice volume tendency due to transport (m/s)</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;       <span class="comment">! internal              U-cell (kg/m s^2)</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;       <span class="keyword">allocate</span>(strocnx(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;strocnx=zero <span class="comment">! ice-ocean stress, x-direction</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;       <span class="keyword">allocate</span>(strocny(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;strocny=zero <span class="comment">! ice-ocean stress, y-direction</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;       <span class="keyword">allocate</span>(strairx(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;strairx=zero <span class="comment">! stress on ice by air, x-direction</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;       <span class="keyword">allocate</span>(strairy(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;strairy=zero <span class="comment">! stress on ice by air, y-direction</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">!       allocate(strtltx(ilo:ihi,jlo:jhi))  ;strtltx=ZERO ! stress due to sea surface slope, x-direction</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">!       allocate(strtlty(ilo:ihi,jlo:jhi))  ;strtlty=ZERO ! stress due to sea surface slope, y-direction</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                         </div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="comment">! Thermodynamics component</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;       <span class="comment">! in from atmosphere</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (ilo:ihi,jlo:jhi)  :: &amp;</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keyword">allocate</span>(zlvl(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;zlvl =zero  <span class="comment">! atm level height (m)</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keyword">allocate</span>(uatm(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;uatm =zero  <span class="comment">! wind speed (m/s)</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keyword">allocate</span>(vatm(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;vatm =zero  <span class="comment">!</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keyword">allocate</span>(pott(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;pott =zero  <span class="comment">! air potential temperature  (K)</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keyword">allocate</span>(tair(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;tair =zero  <span class="comment">! air temperature  (K)</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keyword">allocate</span>(qa  (<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;qa   =zero  <span class="comment">! specific humidity (kg/kg)</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">allocate</span>(rhoa(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;rhoa =1.3_sp<span class="comment">! air density (kg/m^3)</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keyword">allocate</span>(swvdr(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;swvdr=zero  <span class="comment">! sw down, visible, direct  (W/m^2)</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keyword">allocate</span>(swvdf(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;swvdf=zero  <span class="comment">! sw down, visible, diffuse (W/m^2)</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keyword">allocate</span>(swidr(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;swidr=zero  <span class="comment">! sw down, near IR, direct  (W/m^2)</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keyword">allocate</span>(swidf(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;swidf=zero  <span class="comment">! sw down, near IR, diffuse (W/m^2)</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keyword">allocate</span>(flw(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;flw  =zero  <span class="comment">! incoming longwave radiation (W/m^2)</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keyword">allocate</span>(frain(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;frain=zero  <span class="comment">! rainfall rate (kg/m^2 s)</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keyword">allocate</span>(fsnow(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;fsnow=zero  <span class="comment">! snowfall rate (kg/m^2 s)</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                                </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;       <span class="comment">! in from ocean                          </span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                                </div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keyword">allocate</span>(frzmlt(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;frzmlt  =zero  <span class="comment">! freezing/melting potential (W/m^2)</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keyword">allocate</span>(sss  (<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;sss     =zero   <span class="comment">! sea surface salinity (ppt)</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keyword">allocate</span>(sst  (<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;sst     =zero    <span class="comment">! sea surface temperature (C)</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keyword">allocate</span>( tf  (<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ; tf     =zero   <span class="comment">! freezing temperature (C)</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keyword">allocate</span>( hmix(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ; hmix   =zero  <span class="comment">! mixed layer depth (m)</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keyword">allocate</span>( qdp(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))    ; qdp    =zero  <span class="comment">! deep ocean heat flux (W/m^2)</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;       <span class="comment">! out to atmosphere </span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;       <span class="comment">! note albedos are in ice_albedo.F, Tsfc in ice_state.F</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (ilo:ihi,jlo:jhi)  :: &amp;</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;       <span class="keyword">allocate</span>( fsens(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;fsens    =zero   <span class="comment">! sensible heat flux (W/m^2)</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;       <span class="keyword">allocate</span>( flat(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;flat     =zero   <span class="comment">! latent heat flux   (W/m^2)</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;       <span class="keyword">allocate</span>( fswabs(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;fswabs   =zero  <span class="comment">! shortwave flux absorbed in ice and ocean (W/m^2)</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;       <span class="keyword">allocate</span>( flwout(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;flwout   =zero  <span class="comment">! outgoing longwave radiation (W/m^2)</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;       <span class="keyword">allocate</span>( evap(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;evap     =zero <span class="comment">! evaporative water flux (kg/m^2/s)</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;       <span class="keyword">allocate</span>( tref(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;tref     =zero <span class="comment">! 2m atm reference temperature (K)</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;       <span class="keyword">allocate</span>( qref(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;qref     =zero  <span class="comment">! 2m atm reference sp humidity (kg/kg)</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                                     </div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;       <span class="comment">! out to ocean</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;       <span class="keyword">allocate</span>( fresh(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;fresh   =zero  <span class="comment">! fresh water flux to ocean (kg/m^2/s)</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;       <span class="keyword">allocate</span>( fsalt(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;fsalt   =zero  <span class="comment">! salt flux to ocean (kg/m^2/s)</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;       <span class="keyword">allocate</span>( fhnet(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;fhnet   =zero  <span class="comment">! net heat flux to ocean (W/m^2)</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;       <span class="keyword">allocate</span>( fswthru(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) ;fswthru =zero   <span class="comment">! shortwave penetrating to ocean (W/m^2)</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;       <span class="comment">! diagnostic </span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (ilo:ihi,jlo:jhi)  :: &amp;       </span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;       <span class="keyword">allocate</span>(congel(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;congel =zero<span class="comment">! basal ice growth         (m/step--&gt;cm/day)</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;       <span class="keyword">allocate</span>(frazil(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;frazil =zero<span class="comment">! frazil ice growth        (m/step--&gt;cm/day)</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;       <span class="keyword">allocate</span>(snoice(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;snoice =zero<span class="comment">! snow-ice formation       (m/step--&gt;cm/day)</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;       <span class="keyword">allocate</span>(meltt(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;meltt  =zero<span class="comment">! top ice melt             (m/step--&gt;cm/day)</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;       <span class="keyword">allocate</span>(meltb(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;meltb  =zero<span class="comment">! basal ice melt           (m/step--&gt;cm/day)</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;       <span class="keyword">allocate</span>(meltl(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;meltl  =zero<span class="comment">! lateral ice melt         (m/step--&gt;cm/day)</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;       <span class="keyword">allocate</span>(daidtt(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;daidtt =zero<span class="comment">! ice area tendency thermo.   (s^-1)</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;       <span class="keyword">allocate</span>(dvidtt(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))     ;dvidtt =zero<span class="comment">! ice volume tendency thermo. (m/s)</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;       <span class="keyword">allocate</span>(mlt_onset(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;mlt_onset =zero<span class="comment">! day of year that sfc melting begins</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;       <span class="keyword">allocate</span>(frz_onset(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;frz_onset =zero<span class="comment">! day of year that freezing begins (congel or frazil)</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;       <span class="comment">! NOTE: The following ocean diagnostic fluxes measure</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;       <span class="comment">! the same thing as their coupler counterparts but over</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;       <span class="comment">! different time intervals.  The coupler variables are </span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;       <span class="comment">! computed from one to_coupler call to the next, whereas</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;       <span class="comment">! the diagnostic variables are computed over a time step.</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;       <span class="keyword">allocate</span>(fresh_hist(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;fresh_hist  =zero<span class="comment">! fresh water flux to ocean (kg/m^2/s)</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;       <span class="keyword">allocate</span>(fsalt_hist(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;fsalt_hist  =zero<span class="comment">! salt flux to ocean (kg/m^2/s)</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;       <span class="keyword">allocate</span>(fhnet_hist(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;fhnet_hist  =zero<span class="comment">! net heat flux to ocean (W/m^2)</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;       <span class="keyword">allocate</span>(fswthru_hist(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;fswthru_hist=zero<span class="comment">! shortwave penetrating to ocean (W/m^2)</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;       <span class="comment">! internal</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (ilo:ihi,jlo:jhi)  :: &amp;</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;       <span class="keyword">allocate</span>(fsw    (<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;fsw   =zero<span class="comment">!    ! incoming shortwave radiation (W/m^2)</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;       <span class="keyword">allocate</span>(wind  (<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;wind  =zero    <span class="comment">! wind speed (m/s)</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;       <span class="keyword">allocate</span>(shcoef(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;shcoef=zero  <span class="comment">! transfer coefficient for sensible heat</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;       <span class="keyword">allocate</span>(lhcoef(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))   ;lhcoef=zero   <span class="comment">! transfer coefficient for latent heat</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">!c=======================================================================</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">!        subroutine ice_flux_in_def</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__flux__in.html#ae31f4e72ab0b4d8994f234255e402ceb">cldf</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) </div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension(ilo:ihi,jlo:jhi,2)  :: &amp;</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="comment">!allocate(fsw_data  (ilo:ihi,jlo:jhi,2))  ;fsw_data =ZERO! field values at 2 temporal data points</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="comment">!allocate(cldf_data (ilo:ihi,jlo:jhi,2))  ;cldf_data=ZERO    </span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="comment">!allocate(fsnow_data(ilo:ihi,jlo:jhi,2))  ;fsnow_data=ZERO     </span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="comment">!allocate(Tair_data (ilo:ihi,jlo:jhi,2))  ;Tair_data=ZERO     </span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="comment">!allocate(uatm_data (ilo:ihi,jlo:jhi,2))  ;uatm_data=ZERO    </span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="comment">!allocate(vatm_data (ilo:ihi,jlo:jhi,2))  ;vatm_data=ZERO    </span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="comment">!allocate( Qa_data  (ilo:ihi,jlo:jhi,2))  ; Qa_data =ZERO   </span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="comment">!allocate(rhoa_data (ilo:ihi,jlo:jhi,2))  ;rhoa_data=ZERO    </span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="comment">!allocate(potT_data (ilo:ihi,jlo:jhi,2))  ;potT_data=ZERO    </span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="comment">!allocate(zlvl_data (ilo:ihi,jlo:jhi,2))  ;zlvl_data=ZERO    </span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="comment">!allocate( flw_data (ilo:ihi,jlo:jhi,2))  ; flw_data=ZERO    </span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">!allocate(sst_data  (ilo:ihi,jlo:jhi,2))  ;sst_data =ZERO   </span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="comment">!allocate(sss_data  (ilo:ihi,jlo:jhi,2))  ;sss_data =ZERO</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                               </div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">!=======================================================================</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">!       subroutine ice_mechred_def</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      </div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension(ilo:ihi,jlo:jhi) :: &amp;</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__mechred.html#a7574477bf6f9a45d9c5d580340a7f72c">dardg1dt</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) ;<a class="code" href="namespaceice__mechred.html#a7574477bf6f9a45d9c5d580340a7f72c">dardg1dt</a>=zero <span class="comment">! rate of fractional area loss by ridging ice (1/s)</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__mechred.html#a1b1a7c80a1b7f77b554176296ead9de9">dardg2dt</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) ;<a class="code" href="namespaceice__mechred.html#a1b1a7c80a1b7f77b554176296ead9de9">dardg2dt</a>=zero <span class="comment">! rate of fractional area gain by new ridges (1/s)</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__mechred.html#aaa9bebb0223bfa644c93c1b2dda5d672">dvirdgdt</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) ;<a class="code" href="namespaceice__mechred.html#aaa9bebb0223bfa644c93c1b2dda5d672">dvirdgdt</a>=zero <span class="comment">! rate of ice volume ridged (m/s)</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__mechred.html#af2d6fe75b6f2cddc121139c198838c34">opening</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) ;<a class="code" href="namespaceice__mechred.html#af2d6fe75b6f2cddc121139c198838c34">opening</a> =zero <span class="comment">! rate of opening due to divergence/shear (1/s)</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (ilo:ihi,jlo:jhi)  :: &amp;    </span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__mechred.html#aba651c014e5849c5f013553556fbb754">asum</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) ;<a class="code" href="namespaceice__mechred.html#aba651c014e5849c5f013553556fbb754">asum</a> =zero <span class="comment">! sum of total ice and open water area</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__mechred.html#a799f453ee13595354d631bbe7204cef1">aksum</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)) ;<a class="code" href="namespaceice__mechred.html#a799f453ee13595354d631bbe7204cef1">aksum</a>=zero <span class="comment">! ratio of area removed to area ridged</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (ilo:ihi,jlo:jhi,0:ncat) :: &amp;</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__mechred.html#a47985e25a395ebe3fc3fa2b937cd8f5c">apartic</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>,0:<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>)) ; <a class="code" href="namespaceice__mechred.html#a47985e25a395ebe3fc3fa2b937cd8f5c">apartic</a> =zero <span class="comment">! participation function; fraction of ridging/</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (ilo:ihi,jlo:jhi,ncat)  :: &amp;    </span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__mechred.html#a7d3d24ef19a969cfbda15b9816c40ddd">hrmin</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>))  ;<a class="code" href="namespaceice__mechred.html#a7d3d24ef19a969cfbda15b9816c40ddd">hrmin</a>=zero <span class="comment">! minimum ridge thickness</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__mechred.html#a54779eaa3c2052bdd1525ef96a5be9d4">hrmax</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>))  ;<a class="code" href="namespaceice__mechred.html#a54779eaa3c2052bdd1525ef96a5be9d4">hrmax</a>=zero <span class="comment">! maximum ridge thickness</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__mechred.html#a606c65768776f4e8eb121119660e0459">krdg</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>))  ;<a class="code" href="namespaceice__mechred.html#a606c65768776f4e8eb121119660e0459">krdg</a> =zero <span class="comment">! mean ridge thickness/thickness of ridging ice </span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__mechred.html#a5924a79b0e0709252101fa8b6be1f3c8">hrexp</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>))  ;<a class="code" href="namespaceice__mechred.html#a5924a79b0e0709252101fa8b6be1f3c8">hrexp</a>=zero <span class="comment">! ridge e-folding thickness (krdg_redist = 1)</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">!=======================================================================</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">!      subroutine ice_therm_vertical_def</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (ilo:ihi,jlo:jhi,ncat)  ::  &amp;</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;       <span class="keyword">allocate</span>(<a class="code" href="namespaceice__therm__vertical.html#a32cc1b09ad18aff12334d37bd062dbd5">hicen_old</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>))    ;<a class="code" href="namespaceice__therm__vertical.html#a32cc1b09ad18aff12334d37bd062dbd5">hicen_old</a> =zero    <span class="comment">! old ice thickness (m), used by ice_therm_itd</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (ilo:ihi,jlo:jhi)  ::  &amp;</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;       <span class="keyword">allocate</span>(<a class="code" href="namespaceice__therm__vertical.html#af4b7c768b6eed0e7f9f89d2ff7d0643a">rside</a>(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>))  ;<a class="code" href="namespaceice__therm__vertical.html#af4b7c768b6eed0e7f9f89d2ff7d0643a">rside</a> =zero <span class="comment">! fraction of ice that melts laterally</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">!=======================================================================</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="comment">!subroutine ice_therm_itd</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">!     real (kind=dbl_kind), dimension (ilo:ihi,jlo:jhi,ncat) :: &amp;</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__therm__itd.html#a85a7a88cd7fd0cadde2cd9d9b8c28635">hicen</a>(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>)) ;<a class="code" href="namespaceice__therm__itd.html#a85a7a88cd7fd0cadde2cd9d9b8c28635">hicen</a>=zero   <span class="comment">!  ice thickness (m)</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">!=======================================================================</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">!      subroutine  ice_grid_def</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="comment">!allocate(TLAT_G(imt_global,jmt_global))     ;TLAT_G=ZERO! latitude of cell center T grid</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="comment">!allocate(TLON_G(imt_global,jmt_global))     ;TLON_G=ZERO! longitude of cell center T grid</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (imt_local,jmt_local)  ::  &amp;</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="comment">!allocate(dxt(imt_local,jmt_local))    ;dxt=ZERO! width of T-cell through the middle (m)</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="comment">!allocate(dyt(imt_local,jmt_local))    ;dyt=ZERO! height of T-cell through the middle (m)</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="comment">!allocate(dxu(imt_local,jmt_local))    ;dxu=ZERO! width of U-cell through the middle (m)</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="comment">!allocate(dyu(imt_local,jmt_local))    ;dyu=ZERO! height of U-cell through the middle (m)</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="comment">!allocate(HTE(imt_local,jmt_local))    ;HTE=ZERO! length of eastern edge of T-cell (m)</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="comment">!allocate(HTN(imt_local,jmt_local))    ;HTN=ZERO! length of northern edge of T-cell (m)</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="comment">!allocate(HTS(imt_local,jmt_local))    ;HTS=ZERO! length of southern edge of T-cell</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="comment">!allocate(HTW(imt_local,jmt_local))    ;HTW=ZERO! length of western edge of T-cell</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="comment">!allocate(tarea(imt_local,jmt_local))  ;tarea=ZERO! area of T-cell (m^2)</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="comment">!allocate(uarea(imt_local,jmt_local))  ;uarea=ZERO! area of U-cell (m^2)</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__grid.html#a1cf208d9fa47e12e370c5d279f005003">ulon</a>(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))  ;<a class="code" href="namespaceice__grid.html#a1cf208d9fa47e12e370c5d279f005003">ulon</a> =zero<span class="comment">! longitude of velocity pts (radians)</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__grid.html#ac003a32baa0ed51dccd612e4637ed535">ulat</a>(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))  ;<a class="code" href="namespaceice__grid.html#ac003a32baa0ed51dccd612e4637ed535">ulat</a> =zero<span class="comment">! latitude of velocity pts (radians)</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__grid.html#af435d3d80d4ce3a7ae22bb37fa002f03">tlon</a>(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))  ;<a class="code" href="namespaceice__grid.html#af435d3d80d4ce3a7ae22bb37fa002f03">tlon</a> =zero<span class="comment">!  longitude of temp pts (radians)</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__grid.html#a78ed074def6a04bfa70db90aafb82969">tlat</a>(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))  ;<a class="code" href="namespaceice__grid.html#a78ed074def6a04bfa70db90aafb82969">tlat</a> =zero<span class="comment">! latitude of temp pts (radians)</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="comment">!allocate(dxhy (imt_local,jmt_local))  ;dxhy =ZERO! 0.5*(HTE - HTE)</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="comment">!allocate(dyhx (imt_local,jmt_local))  ;dyhx =ZERO! 0.5*(HTN - HTN)</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                             </div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">!      real (kind=dbl_kind), dimension (ilo:;ihi,jlo:jhi)  ::  &amp;</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="comment">!allocate(cyp (ilo:ihi,jlo:jhi))        ;cyp =ZERO! 1.5*HTE - 0.5*HTE</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="comment">!allocate(cxp (ilo:ihi,jlo:jhi))        ;cxp =ZERO! 1.5*HTN - 0.5*HTN</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="comment">!allocate(cym (ilo:ihi,jlo:jhi))        ;cym =ZERO! 0.5*HTE - 1.5*HTE</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="comment">!allocate(cxm (ilo:ihi,jlo:jhi))        ;cxm =ZERO! 0.5*HTN - 1.5*HTN</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="comment">!allocate(dxt2(ilo:ihi,jlo:jhi))        ;dxt2=ZERO! 0.5*dxt</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="comment">!allocate(dyt2(ilo:ihi,jlo:jhi))        ;dyt2=ZERO! 0.5*dyt</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="comment">!allocate(dxt4(ilo:ihi,jlo:jhi))        ;dxt4=ZERO! 0.25*dxt</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="comment">!allocate(dyt4(ilo:ihi,jlo:jhi))        ;dyt4=ZERO! 0.25*dyt</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">!allocate(tarear  (ilo:ihi,jlo:jhi))    ;tarear  =ZERO! 1/tarea</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="comment">!allocate(uarear  (ilo:ihi,jlo:jhi))    ;uarear  =ZERO! 1/uarea</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="comment">!allocate(tinyarea(ilo:ihi,jlo:jhi))    ;tinyarea=ZERO! puny*tarea</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="comment">!allocate(ANGLE   (ilo:ihi,jlo:jhi))    ;ANGLE   =ZERO! for conversions between POP grid and lat/lon</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="comment">!allocate(ANGLET  (ilo:ihi,jlo:jhi))    ;ANGLET  =ZERO! ANGLE converted to T-cells</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="comment">!allocate(tarean  (ilo:ihi,jlo:jhi))    ;tarean  =ZERO! area of NH T-cells</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="comment">!allocate(tareas  (ilo:ihi,jlo:jhi))    ;tareas  =ZERO! area of SH T-cells</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">! Masks</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">!     real (kind=dbl_kind), dimension (imt_local,jmt_local)  ::  &amp;</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keyword">allocate</span>(hm    (<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))    ; <a class="code" href="namespaceice__grid.html#a86bf5bfb68fae14effe3893614dfc6ae">hm</a>     =zero<span class="comment">! land/boundary mask, thickness (T-cell)</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="comment">!allocate(uvm   (imt_local,jmt_local))    ; uvm    =ZERO! land/boundary mask, velocity (U-cell)</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="comment">!allocate(mask_n(imt_local,jmt_local))    ; mask_n =ZERO! northern hemisphere</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="comment">!allocate(mask_s(imt_local,jmt_local))    ; mask_s =ZERO! southern hemisphere</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">!      logical (kind=log_kind)  ::  &amp;</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__grid.html#a667faa0f8cb8b48d875aad2fff969008">tmask</a>(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))   ;<a class="code" href="namespaceice__grid.html#a667faa0f8cb8b48d875aad2fff969008">tmask</a> =.true.  <span class="comment">! land/boundary mask, thickness (T-cell)</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespaceice__grid.html#a2078ef17c456ac3a3624e575ae494492">umask</a>(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a>))   ;<a class="code" href="namespaceice__grid.html#a2078ef17c456ac3a3624e575ae494492">umask</a> =.true.  <span class="comment">! land/boundary mask, velocity (U-cell)</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">!      allocate(tmask(imt_local,jmt_local))  ;tmask =c1i  ! land/boundary mask, thickness (T-cell)</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">!      allocate(umask(imt_local,jmt_local))  ;umask =c1i  ! land/boundary mask, velocity (U-cell)</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="comment">!allocate(icetmask(ilo:ihi,jlo:jhi))   ;icetmask =ZERO! ice extent mask (T-cell)</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="comment">!allocate(iceumask(ilo:ihi,jlo:jhi))   ;iceumask =ZERO! ice extent mask (U-cell)</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;     <span class="comment">!====================================================================</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">!       my_task,      &amp;          ! task id for local process</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">!       master_task            ! task id for master process</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="namespaceice__domain.html#abdbb026511410be56e5b49095579bf15">my_task</a>=myid    <span class="comment">! processor id</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="namespaceice__domain.html#a9069546ddbdc761fe347991cb8475161">master_task</a> = 1  <span class="comment">! master processer id</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">!--------------------------------------------------------------</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">!====================================================================</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="comment">! timing devices</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">!      call ice_timer_clear(-1) ! initialize all timers</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">!      call ice_timer_start(0)  ! begin timing entire run</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">! parameters, grid, parameterizations, etc</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keyword">call </span>init_constants      <span class="comment">! pi, etc</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__init.html#a8aeb5361cfea01402260b8b2727a2f4a">input_data</a>          <span class="comment">! namelist variables</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__grid.html#a07f851c9a83f3e03a4ada92b12812721">init_grid</a>           <span class="comment">! grid variables</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">!      if (advection == &#39;remap&#39;) </span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">!     &amp;     call init_remap     ! more grid variables</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">!      call init_calendar       ! initialize some calendar stuff</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">!      call init_hist           ! initialize output history file</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">!      call init_evp            ! define evp dynamics parameters, variables</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__init.html#a5415eb5796bc1fd1eac438d37fdcd358">init_flux</a>           <span class="comment">! initialize coupler fluxes</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__therm__vertical.html#a1123b2b5ee24c8b82a26c5a831c88405">init_thermo_vertical</a> <span class="comment">! initialize vertical thermodynamics</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__mechred.html#ae61458b8a88c5235b64bd4db1e35f42b">init_mechred</a>        <span class="comment">! initialize ridging variables</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__itd.html#a2c5da98ae0797cd69f98ffce134e4ef7">init_itd</a>            <span class="comment">! initialize ice thickness distribution</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">!     set the initial ice field base on the latitude</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">!      if (restart) call restartfile       ! start from restart data</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">!      call calendar(time)      ! determine the initial date</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">!#ifdef coupled</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">!      call init_cpl            ! initialize message passing </span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">!#else</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__flux__in.html#ad3300da51a0b8d4d6d51723d593ac9a4">init_getflux</a>        <span class="comment">! initialize forcing data info</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">!#endif</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;       <span class="keywordflow">Do</span> i=1,m <span class="comment">!T</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;         tair(i,1)=273.15+t_air(i)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;       <span class="keyword">call </span><a class="code" href="namespaceice__init.html#aafefd572779d7e57a1c62b63ecec3813">init_state</a>          <span class="comment">! initialize the ice state</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      dtice = dti</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">IF</span>(<a class="code" href="namespacemod__utils.html#af4d60bccc1216e0c740fcefc0674ef9b">dbg_set</a>(<a class="code" href="namespacemod__utils.html#a4daeef481645d2d17b535a634a45701c">dbg_log</a>)) <span class="keyword">write</span>(ipt,*)<span class="stringliteral">&#39; ICE time step set to DTI dtice =&#39;</span> , dtice</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keyword">call </span>alloc_uvice</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__albedo.html#a50f81c9c840048f8ae4fcd55b44aea86">albedos</a>             <span class="comment">! albedo based on initial ice distribution</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">IF</span>(<a class="code" href="namespacemod__utils.html#af4d60bccc1216e0c740fcefc0674ef9b">dbg_set</a>(<a class="code" href="namespacemod__utils.html#a60e94d6abe4ceab6a20f4e569a826bea">dbg_sbr</a>)) <span class="keyword">write</span>(ipt,*)<span class="stringliteral">&#39;END ice_init_0&#39;</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="keyword">      end subroutine </span>ice_init_0</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">!=======================================================================</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">! !IROUTINE: from_coupler - input from coupler to sea ice model</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">! !INTERFACE:</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keyword">      subroutine </span>from_coupler</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">!!DESCRIPTION:</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">! Reads input data from coupler to sea ice model</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordtype">integer</span> :: i,j,icn,n2   <span class="comment">! local loop indices</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordtype">integer</span> :: ii,i1,i2,j1,j2   <span class="comment">! local loop indices</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordtype">real</span>  ::   gsum, workx, worky</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordtype">REAL(SP)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension (:,:)</span> :: rbuf</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">!     first step initialized the ice variables</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      zlvl(:,:)    = c10i</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      uatm(:,:)    = 0.0_sp</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      vatm(:,:)    = 0.0_sp</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      pott(:,:)    = 0.0_sp</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      tair(:,:)    = 0.0_sp</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      qa(:,:)      = 0.0_sp</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      rhoa(:,:)    = 1.3_sp</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      swvdr(:,:)   = 0.0_sp</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      swvdf(:,:)   = 0.0_sp</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      swidr(:,:)   = 0.0_sp</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      swidf(:,:)   = 0.0_sp</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      flw(:,:)     = 0.0_sp</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      frain(:,:)   = 0.0_sp</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      fsnow(:,:)   = 0.0_sp</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      sst(:,:)     = 0.0_sp</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      sss(:,:)     = 0.0_sp</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="comment">!uocn(:,:)    = 0.0_SP</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="comment">!vocn(:,:)    = 0.0_SP</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="comment">!ss_tltx(:,:) = 0.0_SP</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="comment">!ss_tlty(:,:) = 0.0_SP</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      frzmlt(:,:)  = 0.0_sp</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">do</span> j=<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>,<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">do</span> i=<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>,<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;         <span class="comment">!--- ocn states--</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;         sst(i,j) = <a class="code" href="namespaceall__vars.html#a8879771294c6ba010ba590466d1b3980">t1</a>(i,1) <span class="comment">!+Tffresh</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;         sss(i,j) = <a class="code" href="namespaceall__vars.html#ae96b4b252fe0654986c9565b881600e7">s1</a>(i,1)</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;         tf  (i,j) = -depresst*sss(i,j) <span class="comment">! freezing temp (C)</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;         tf  (i,j) = max(tf(i,j),-1.85) <span class="comment">! freezing temp (C)</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;         <span class="comment">!--- atm states-</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;         zlvl(i,j) = c10i</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;         tair(i,j) = t_air(i) +tffresh  <span class="comment">!  ^0C---&gt;&quot;K&quot;</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;         pott(i,j) = tair(i,j)          <span class="comment">! K </span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;         qa  (i,j) = qa_air(i)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;         rhoa(i,j) = 1.3_sp <span class="comment">!rhoair</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;         <span class="comment">!--- ocn states--</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;         <span class="comment">! compute potential to freeze or melt ice</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;         frzmlt(i,j) = (tf(i,j)-sst(i,j))*cp_ocn*rhow*(d(i))*<a class="code" href="namespaceall__vars.html#a40b9f762b932c81996806be8a1bea937">dz</a>(i,1)/dtice</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;         frzmlt(i,j) = min(max(frzmlt(i,j),-c1000),c1000)</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;         <span class="keywordflow">if</span> (sst(i,j) &lt;= tf(i,j)) <span class="keywordflow">then</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            sst(i,j) = tf(i,j)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <a class="code" href="namespaceall__vars.html#a8879771294c6ba010ba590466d1b3980">t1</a>(i,1)=tf(i,j)</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;       </div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;       <span class="comment">!--- atm fluxes--</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;       <span class="comment">!!======================================================</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;          fsw(i,j)  = dsw_air(i)</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;          <a class="code" href="namespaceice__flux__in.html#ae31f4e72ab0b4d8994f234255e402ceb">cldf</a>(i,j)  = cloud(i)</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;       <span class="comment">!!======================================================</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;          fsnow(i,j)=0.0_sp</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;          fsnow(i,j) = (<a class="code" href="namespaceall__vars.html#a8072fea2c4f14e498f4ae52593d35f84">qprec</a>(i)+<a class="code" href="namespaceall__vars.html#ad0806891c01947edc17e4e4d081c12e3">qevap</a>(i))*rhofresh   <span class="comment">!m/s---&gt; kg/m^2/s</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;          frain(i,j) = c0i</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span> (tair(i,j) &gt;= tffresh) <span class="keywordflow">then</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;          frain(i,j) = fsnow(i,j)</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;          fsnow(i,j) = c0i</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">!!======================================================</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;         <span class="comment">!!=============================================</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;         <span class="comment">!! Special treatment the river mouth          !</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;         <span class="comment">!! No new ice add at river mouth</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;         <span class="comment">!! Caused by the salinity changing and the</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;         <span class="comment">!! freezing potential increasing</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;         <span class="comment">!!=============================================</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;     <span class="keywordflow">IF</span>(river_inflow_location == <span class="stringliteral">&#39;node&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;       <span class="keywordflow">IF</span>(numqbc &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;         <span class="keywordflow">DO</span> j=1,numqbc</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;           i1=<a class="code" href="namespaceall__vars.html#a7061ce24690eeffdde5c39c53967a31e">inodeq</a>(j)</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;           <span class="keywordflow">IF</span>(frzmlt(i1,1)&gt;0) frzmlt(i1,1)=0.0</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keywordflow">        END IF</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;     <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(river_inflow_location == <span class="stringliteral">&#39;edge&#39;</span>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;       <span class="keywordflow">IF</span>(numqbc &gt; 0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;         <span class="keywordflow">DO</span> j=1,numqbc</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;           j1=<a class="code" href="namespaceall__vars.html#a86b299505f5be46e717242940c79ea50">n_icellq</a>(j,1)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;           j2=<a class="code" href="namespaceall__vars.html#a86b299505f5be46e717242940c79ea50">n_icellq</a>(j,2)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;           <span class="keywordflow">IF</span>(frzmlt(j1,1)&gt;0) frzmlt(j1,1)=0.0</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;           <span class="keywordflow">IF</span>(frzmlt(j2,1)&gt;0) frzmlt(j2,1)=0.0</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;         ii=<a class="code" href="namespaceall__vars.html#a81e289fe52a66153857f91780db643e3">icellq</a>(j)</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          <span class="keywordflow">DO</span> i1=1,3</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="keywordflow">IF</span>(<a class="code" href="namespaceall__vars.html#a401dd74516325086c3c3a13bd6cd7d56">isonb</a>(<a class="code" href="namespaceall__vars.html#a9d3143499e0af831a6e497eb590354ac">nv</a>(ii,i1))==0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;              i2=<a class="code" href="namespaceall__vars.html#a9d3143499e0af831a6e497eb590354ac">nv</a>(ii,i1)</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keywordflow">            END IF</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keywordflow">          END DO</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;           <span class="keywordflow">IF</span>(isicen(i2)==1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;           <span class="comment">!IF(frzmlt(J1,1)&gt;0) </span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            frzmlt(j1,1)=frzmlt(i2,1)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;           <span class="comment">!IF(frzmlt(J2,1)&gt;0) </span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            frzmlt(j2,1)=frzmlt(i2,1)</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="keywordflow">           END IF</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keywordflow">       END IF</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="keywordflow">     END IF</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">!!======================================================</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      uatm =0.0_sp</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      vatm =0.0_sp</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      wind =0.0_sp</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   <span class="keywordflow">DO</span> i=1,m</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keywordflow">DO</span> i1=1, <a class="code" href="namespaceall__vars.html#a45fa8cb66444fb18eb86a299cd9425c7">ntve</a>(i)</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;         uatm(i,1) =uatm(i,1)+<a class="code" href="namespaceall__vars.html#aa0eab3881f061cf17524342858a10a6d">uuwind</a>(<a class="code" href="namespaceall__vars.html#ad42856b79f21ee239a519a1ecc20c8e8">nbve</a>(i,i1))</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;         vatm(i,1) =vatm(i,1)+<a class="code" href="namespaceall__vars.html#ae411c729670736963c9688aee251c6fe">vvwind</a>(<a class="code" href="namespaceall__vars.html#ad42856b79f21ee239a519a1ecc20c8e8">nbve</a>(i,i1))</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;         wind(i,1) =wind(i,1)+ sqrt(<a class="code" href="namespaceall__vars.html#aa0eab3881f061cf17524342858a10a6d">uuwind</a>(<a class="code" href="namespaceall__vars.html#ad42856b79f21ee239a519a1ecc20c8e8">nbve</a>(i,i1))**2 + <a class="code" href="namespaceall__vars.html#ae411c729670736963c9688aee251c6fe">vvwind</a>(<a class="code" href="namespaceall__vars.html#ad42856b79f21ee239a519a1ecc20c8e8">nbve</a>(i,i1))**2) <span class="comment">! wind speed, m/s</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      uatm(i,1) = uatm(i,1) /float(<a class="code" href="namespaceall__vars.html#a45fa8cb66444fb18eb86a299cd9425c7">ntve</a>(i))</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      vatm(i,1) = vatm(i,1) /float(<a class="code" href="namespaceall__vars.html#a45fa8cb66444fb18eb86a299cd9425c7">ntve</a>(i))</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      wind(i,1) = sqrt(uatm(i,1) * uatm(i,1)+vatm(i,1)*vatm(i,1))</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="keywordflow">   END DO</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="preprocessor">#   if defined (MULTIPROCESSOR)</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="preprocessor"></span>     <span class="keyword">allocate</span>(rbuf(0:mt,3))</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;     rbuf =0.0</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;     rbuf(1:m,1)=uatm(1:m,1)</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;     rbuf(1:m,2)=vatm(1:m,1)</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;     rbuf(1:m,3)=wind(1:m,1)</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;     <span class="keywordflow">if</span> (par) <span class="keyword">CALL </span>node_match(1,<a class="code" href="namespacemod__par.html#a79180bf58af0a0e24de12aa8c5b4b21d">nbn</a>,<a class="code" href="namespacemod__par.html#aed65ebed23fd5b188015e8df7c549624">bn_mlt</a>,<a class="code" href="namespacemod__par.html#a7ca332c77f501334fff64fc71f745859">bn_loc</a>,bnc,mt,3,myid,nprocs,rbuf)</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;     <span class="keywordflow">IF</span>(par)<span class="keyword">CALL </span>aexchange(nc,myid,nprocs,rbuf)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;     uatm(1:m,1)=rbuf(1:m,1)</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;     vatm(1:m,1)=rbuf(1:m,2)</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;     wind(1:m,1)=rbuf(1:m,3)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;     <span class="keyword">deallocate</span>(rbuf)</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor">#   endif</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">!-----+----------------------------------------------------------------+</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">!    some parameter correction</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">!    Qa, Fsw , SW--&gt;SWvdr SWVDF SWidr SWidf , FLW, frain, frain</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;       <span class="keyword">call </span><a class="code" href="namespaceice__flux__in.html#aa4efb0fb0043cffafb7436fe6cbdad12">prepare_forcing</a>  <span class="comment">!scale input forcing data</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="keyword">      end subroutine </span>from_coupler</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">!=======================================================================</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">!BOP</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">! !IROUTINE: to_coupler - send data from sea ice model to coupler</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">! !INTERFACE:</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keyword">      subroutine </span>to_coupler</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">! !DESCRIPTION:</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">! Sea ice model to coupler</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordtype">use </span><a class="code" href="namespaceice__flux.html">ice_flux</a></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordtype">integer(kind=int_kind)</span> :: i,j,k,icn,n2     <span class="comment">! local loop indices</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordtype">real (kind=dbl_kind)</span> ::    &amp;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;         gsum, workx, worky      &amp;     <span class="comment">! tmps for converting grid</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      ,  tsrf (<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)  &amp;     <span class="comment">! surface temperature</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      ,  tauxa(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)  &amp;     <span class="comment">! atmo/ice stress</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      ,  tauya(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)  &amp;             </div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      ,  tauxo(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)  &amp;     <span class="comment">! ice/ocean stress</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      ,  tauyo(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)  &amp;             </div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      ,  ailohi(<a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>:<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a>,<a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>:<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a>)      <span class="comment">! fractional ice area</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="keywordtype">logical</span> :: flag</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">!!=================================================================</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordtype">REAL(SP)</span> :: spro,spcp,rosea</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordtype">REAL(SP)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension (:,:)</span> :: rbuf</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordtype">REAL (SP)</span> :: naice   <span class="comment">! </span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">!!=================================================================</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">!--------ice_ocean---------------------------------------------------</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">parameter</span> ::  &amp;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        cphm = cp_ocn*rhow*20 <span class="comment">!hmix</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keywordtype">REAL (SP)</span> :: duvi,ice_ocndx, ice_ocndy  <span class="comment">! for ice-ocean drag </span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">!--------atmo-ocean---------------------------------------------------</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordtype">real (kind=dbl_kind)</span>, <span class="keywordtype">dimension(ilo:ihi,jlo:jhi)</span> ::&amp;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;         delt     &amp;<span class="comment">! potential temperature difference   (K)</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      ,  delq     &amp;<span class="comment">! specific humidity difference   (kg/kg)</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      ,  dummy1, dummy2, dummy3, dummy4  <span class="comment">! dummy arrays</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keywordtype">real (kind=dbl_kind)</span> :: &amp;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;         tsfk     &amp;<span class="comment">! surface temperature (K)</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      ,  fsh      &amp;<span class="comment">! sensible heat flux  (W/m^2)</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      ,  flh      &amp;<span class="comment">! latent heat flux    (W/m^2)</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      ,  swabs    &amp;<span class="comment">! surface absorbed shortwave heat flux (W/m^2)</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      ,  flwup     <span class="comment">! long-wave upward heat flux  (W/m^2)</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">!!====================================================================</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;     flag  =.false.</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;     spcp  = 4.2174e3_sp</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;     rosea = 1.023e3_sp</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;     spro  = spcp*rosea</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">!  calculate the heat budget at the surface of ocean</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">!!====================================================================</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">!!====================================================================</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">!!      if(.false.) then</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__atmo.html#ac4d5d2b9675d614e780ff2ceef534c4a">atmo_boundary_layer</a> (1, <span class="stringliteral">&#39;ocn&#39;</span>, sst, &amp;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;           dummy1, dummy2, dummy3, dummy4, delt,  delq)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="keywordflow">do</span> j = <a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>,<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">do</span> i = <a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>,<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;         <span class="comment">! ocean surface temperature in Kelvin</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;         tsfk = sst(i,j) + tffresh</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;         <span class="comment">! shortwave radiative flux</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;         swabs = (c1i - <a class="code" href="namespaceice__albedo.html#a5f9b8615897813e81ac516d22ba1fdb1">albocn</a>) * <a class="code" href="namespaceice__flux.html#a5b30de4b43f8bb404bb4c79ae2ee9ff2">fsw</a>(i,j)</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;         <span class="comment">! longwave radiative flux</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;         flwup  = -stefan_boltzmann * tsfk**4</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;         <span class="comment">! downward latent and sensible heat fluxes</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;         flh = <a class="code" href="namespaceice__flux.html#af7638513b5af246df1a6e59cf17ca1f5">lhcoef</a>(i,j) * delq(i,j)</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;         fsh = <a class="code" href="namespaceice__flux.html#ab881ac593bc7b8b51e393ebcd241cfaa">shcoef</a>(i,j) * delt(i,j)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;         <a class="code" href="namespaceall__vars.html#a2033f4e36f7d6c8309e9074a7d5e6d2d">wtsurf</a>(i) = -(fsh + flh + flwup + flw(i,j)+swabs ) /spro </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;         <a class="code" href="namespaceall__vars.html#ac02f56f584500f6ae8d3d6e321ba3732">swrad</a>(i)  =  (c1i-<a class="code" href="namespaceice__albedo.html#a5f9b8615897813e81ac516d22ba1fdb1">albocn</a>)*<a class="code" href="namespaceall__vars.html#ac02f56f584500f6ae8d3d6e321ba3732">swrad</a>(i)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="keywordflow">       end do</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="keywordflow">     end do</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">!     endif </span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">!!====================================================================</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="keywordflow">do</span> j = <a class="code" href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">jlo</a>,<a class="code" href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">jhi</a></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="keywordflow">do</span> i = <a class="code" href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ilo</a>,<a class="code" href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ihi</a></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;       <span class="keywordflow">if</span> (aice(i,j) &gt; puny) <span class="keywordflow">then</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;         <span class="comment">!!==========================================================</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;         <span class="comment">! When the ocean is coupled to a sea-ice model, the temperature</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;         <span class="comment">! surface boundary condiction switches from a Neuman to a Dirichlet</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;         <span class="comment">! boundary condiction: the surface heat flux is no more specified,</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;         <span class="comment">! but diagnosed from the setting of the freezing temperature at the</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;         <span class="comment">! first ocean level</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;         <span class="comment">! the net heat including the second part, tha</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;           <a class="code" href="namespaceall__vars.html#a2033f4e36f7d6c8309e9074a7d5e6d2d">wtsurf</a>(i) =  <a class="code" href="namespaceall__vars.html#a2033f4e36f7d6c8309e9074a7d5e6d2d">wtsurf</a>(i)*(c1i-aice(i,1)) &amp;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                       -fhnet(i,j) /spro &amp; </div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                       -fswthru(i,j)/spro </div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="comment">!  the short wave two parts</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="comment">!  first:  the open region</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="comment">!  second: penetrating through the ice to ocean</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;           <a class="code" href="namespaceall__vars.html#ac02f56f584500f6ae8d3d6e321ba3732">swrad</a>(i)  = <a class="code" href="namespaceall__vars.html#ac02f56f584500f6ae8d3d6e321ba3732">swrad</a>(i)*(c1i-aice(i,1))  -fswthru(i,j)/spro </div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keywordflow">        end if</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="keywordflow">        enddo</span>                   <span class="comment">! i</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keywordflow">      enddo</span>                     <span class="comment">! j</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="keywordflow">DO</span> i=1,m </div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;         <span class="keywordflow">IF</span>(<a class="code" href="namespaceall__vars.html#a8879771294c6ba010ba590466d1b3980">t1</a>(i,1) .LT. tf(i,1)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;           <a class="code" href="namespaceall__vars.html#a8879771294c6ba010ba590466d1b3980">t1</a>(i,1) = tf(i,1)</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="keywordflow">         END IF</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;         <span class="keywordflow">DO</span> k=2,kbm1</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;         <span class="keywordflow">IF</span>(<a class="code" href="namespaceall__vars.html#a8879771294c6ba010ba590466d1b3980">t1</a>(i,k) .LT. tf(i,1)) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;           <a class="code" href="namespaceall__vars.html#a8879771294c6ba010ba590466d1b3980">t1</a>(i,k) = tf(i,1)</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="keywordflow">         END IF</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keywordflow">         END DO</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="keywordflow">      END DO</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="preprocessor"># if defined (MULTIPROCESSOR)</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="preprocessor"></span>       <span class="keywordflow">IF</span>(par) <span class="keyword">CALL </span>aexchange(nc,myid,nprocs,<a class="code" href="namespaceall__vars.html#a8879771294c6ba010ba590466d1b3980">t1</a>)</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keyword">CALL </span><a class="code" href="namespaceall__vars.html#a1791756d6e4e49a3a20fb40985850c0a">n2e3d</a>(<a class="code" href="namespaceall__vars.html#a8879771294c6ba010ba590466d1b3980">t1</a>,<a class="code" href="namespaceall__vars.html#ae97d24576113fd6d6cbe7a5a32938301">t</a>)                               <span class="comment">!Shift to Elements         !</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">!!======================================================</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">!!======================================================</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="preprocessor"># if defined (MULTIPROCESSOR)</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="preprocessor"></span>       <span class="keywordflow">IF</span>(par) <span class="keyword">CALL </span>node_match(1,<a class="code" href="namespacemod__par.html#a79180bf58af0a0e24de12aa8c5b4b21d">nbn</a>,<a class="code" href="namespacemod__par.html#aed65ebed23fd5b188015e8df7c549624">bn_mlt</a>,<a class="code" href="namespacemod__par.html#a7ca332c77f501334fff64fc71f745859">bn_loc</a>,bnc,mt,1,myid,nprocs,<a class="code" href="namespaceall__vars.html#a2033f4e36f7d6c8309e9074a7d5e6d2d">wtsurf</a>,<a class="code" href="namespaceall__vars.html#ac02f56f584500f6ae8d3d6e321ba3732">swrad</a>)</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;       <span class="keywordflow">IF</span>(par) <span class="keyword">CALL </span>aexchange(nc,myid,nprocs,<a class="code" href="namespaceall__vars.html#a2033f4e36f7d6c8309e9074a7d5e6d2d">wtsurf</a>,<a class="code" href="namespaceall__vars.html#ac02f56f584500f6ae8d3d6e321ba3732">swrad</a>)</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;       <span class="keywordflow">DO</span> i=1,m</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keywordflow">IF</span>(isicen(i)==1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;         <a class="code" href="namespaceall__vars.html#ad0806891c01947edc17e4e4d081c12e3">qevap</a>(i)=(1-aice(i,1))*<a class="code" href="namespaceall__vars.html#ad0806891c01947edc17e4e4d081c12e3">qevap</a>(i) <span class="comment">!+EVAP(I,1)/RHOFRESH</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;         <a class="code" href="namespaceall__vars.html#a8072fea2c4f14e498f4ae52593d35f84">qprec</a>(i)=(1-aice(i,1))*<a class="code" href="namespaceall__vars.html#a8072fea2c4f14e498f4ae52593d35f84">qprec</a>(i)+(fresh(i,1)-evap(i,1))/rhofresh</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          <span class="comment">! evap  :: flux of vapor, atmos to ice   (kg m-2 s-1)</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          <span class="comment">!! this is the part lost from the ocean and ice system</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;          <span class="comment">!          &lt; 0 =&gt; sublimation</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          <span class="comment">!          &gt; 0 =&gt; condensation</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          <span class="comment">! Fresh :: flux of water, ice to ocean   (kg/m^2/s)</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          <span class="comment">!          negetive  ---&gt; ice freezing</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          <span class="comment">!          positive  ---&gt; ice melting</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="preprocessor">#        if !defined (SEMI_IMPLICIT)</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="preprocessor"></span>         <a class="code" href="namespaceall__vars.html#a4157035e8b6719ef6a626a12ef6acaf8">qprec2</a>(i) = <a class="code" href="namespaceall__vars.html#a8072fea2c4f14e498f4ae52593d35f84">qprec</a>(i)</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;         <a class="code" href="namespaceall__vars.html#ac38b16a30aa51c0a98e2fbb193ad8967">qevap2</a>(i) = <a class="code" href="namespaceall__vars.html#ad0806891c01947edc17e4e4d081c12e3">qevap</a>(i)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="preprocessor">#        endif</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="keywordflow">        END IF</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="keywordflow">       END DO</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="preprocessor"># if defined (MULTIPROCESSOR)</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="preprocessor"></span>       <span class="keywordflow">if</span>(par) <span class="keyword">CALL </span>node_match(1,<a class="code" href="namespacemod__par.html#a79180bf58af0a0e24de12aa8c5b4b21d">nbn</a>,<a class="code" href="namespacemod__par.html#aed65ebed23fd5b188015e8df7c549624">bn_mlt</a>,<a class="code" href="namespacemod__par.html#a7ca332c77f501334fff64fc71f745859">bn_loc</a>,bnc,mt,1,myid,nprocs,<a class="code" href="namespaceall__vars.html#a8072fea2c4f14e498f4ae52593d35f84">qprec</a>,<a class="code" href="namespaceall__vars.html#ad0806891c01947edc17e4e4d081c12e3">qevap</a>)</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;       <span class="keywordflow">IF</span>(par) <span class="keyword">CALL </span>aexchange(nc,myid,nprocs,<a class="code" href="namespaceall__vars.html#a8072fea2c4f14e498f4ae52593d35f84">qprec</a>,<a class="code" href="namespaceall__vars.html#ad0806891c01947edc17e4e4d081c12e3">qevap</a>)</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="preprocessor">#      if !defined (SEMI_IMPLICIT)</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="preprocessor"></span>       <span class="keywordflow">if</span>(par) <span class="keyword">CALL </span>node_match(1,<a class="code" href="namespacemod__par.html#a79180bf58af0a0e24de12aa8c5b4b21d">nbn</a>,<a class="code" href="namespacemod__par.html#aed65ebed23fd5b188015e8df7c549624">bn_mlt</a>,<a class="code" href="namespacemod__par.html#a7ca332c77f501334fff64fc71f745859">bn_loc</a>,bnc,mt,1,myid,nprocs,<a class="code" href="namespaceall__vars.html#a4157035e8b6719ef6a626a12ef6acaf8">qprec2</a>,<a class="code" href="namespaceall__vars.html#ac38b16a30aa51c0a98e2fbb193ad8967">qevap2</a>)</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;       <span class="keywordflow">IF</span>(par) <span class="keyword">CALL </span>aexchange(nc,myid,nprocs,<a class="code" href="namespaceall__vars.html#a4157035e8b6719ef6a626a12ef6acaf8">qprec2</a>,<a class="code" href="namespaceall__vars.html#ac38b16a30aa51c0a98e2fbb193ad8967">qevap2</a>)</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="preprocessor">#      endif</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="preprocessor"></span><span class="preprocessor"># endif</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keyword">      end subroutine </span>to_coupler</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">!==============================================================</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">!==============================================================</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="comment">! Main driver routine for FVCOM and UG-CICE and FVCOM</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="comment">!</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="comment">!</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="keyword">    subroutine </span>ice_1d_2d</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="preprocessor"># if defined (MULTIPROCESSOR)</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="preprocessor"></span>   <span class="keywordtype">USE </span><a class="code" href="namespacemod__par.html">mod_par</a></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="preprocessor"></span>   <span class="keywordtype">USE </span><a class="code" href="namespacebcs.html">bcs</a></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;   <span class="keywordtype">USE </span><a class="code" href="namespacemod__obcs.html">mod_obcs</a></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  </div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;     <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;     <span class="keywordtype">integer</span> :: i,ii,j,ij,k,ni, jj</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;     <span class="keywordtype">REAL(SP)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension (:,:)</span> :: rbuf</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;     <span class="keywordtype">REAL(SP)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension (:)</span> :: irbuf</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">!--------------------------------------------------------------</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">!        for advection of ice variables</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">!--------------------------------------------------------------</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keywordtype">integer (kind=int_kind)</span>, <span class="keywordtype">parameter</span> ::   &amp;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        narr = 1 + 5*<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a>     <span class="comment">! number of state variable arrays</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordtype">integer (kind=int_kind)</span> :: &amp;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;       narrays          <span class="comment">! counter for number of state variable arrays</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordtype">real (kind=dbl_kind)</span> :: works(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,narr)  <span class="comment">!works(imt_local,narr)</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordtype">real (kind=dbl_kind)</span> :: worke(<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a>,<a class="code" href="namespaceice__model__size.html#aad5690a90b6f7ad823dba09d293ca892">ntilay</a>)</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keywordtype">real (kind=dbl_kind)</span> :: ttmin,ttmax</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordtype">integer</span> :: iout</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keywordtype">integer</span>  :: kice</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">!--------------------------------------------------------------</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="comment">! initializations</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="keywordflow">IF</span>(<a class="code" href="namespacemod__utils.html#af4d60bccc1216e0c740fcefc0674ef9b">dbg_set</a>(<a class="code" href="namespacemod__utils.html#a60e94d6abe4ceab6a20f4e569a826bea">dbg_sbr</a>)) <span class="keyword">WRITE</span>(ipt,*) <span class="stringliteral">&quot;START ICE_1d_2d&quot;</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keyword">ALLOCATE</span>(aicetmp(0:mt));   aicetmp = 0.0_sp</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keyword">ALLOCATE</span>(imass1(0:nt)) ;   imass1  = 0.0_sp</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keyword">ALLOCATE</span>(imass(0:mt))  ;   imass   = 0.0_sp</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    isicec_old = isicec  <span class="comment">!  ice in last step</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    isicec = 0</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    isicen = 0</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    imass  =0.0_sp</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    imass1 =0.0_sp</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;     <span class="keywordflow">DO</span> i=1,m <span class="comment">!T</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;       <span class="keywordflow">IF</span> (aice(i,1) &gt;p001) <span class="keywordflow">then</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;       imass(i) = (rhoi*vice(i,1) + rhos*vsno(i,1)) <span class="comment">! kg/m^2</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;       <span class="keywordflow">IF</span> (imass(i) &gt;p01) isicen(i) =1</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="keywordflow">       END IF</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="keywordflow">     END DO</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="preprocessor"># if defined (MULTIPROCESSOR)</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="preprocessor"></span>       <span class="keywordflow">IF</span>(par) <span class="keyword">CALL </span>node_match(1,<a class="code" href="namespacemod__par.html#a79180bf58af0a0e24de12aa8c5b4b21d">nbn</a>,<a class="code" href="namespacemod__par.html#aed65ebed23fd5b188015e8df7c549624">bn_mlt</a>,<a class="code" href="namespacemod__par.html#a7ca332c77f501334fff64fc71f745859">bn_loc</a>,bnc,mt,1,myid,nprocs,imass)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;       <span class="keywordflow">IF</span>(par) <span class="keyword">CALL </span>aexchange(nc,myid,nprocs,imass)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   <span class="keyword">CALL  </span><a class="code" href="namespaceall__vars.html#ac376e20484e1be61da82494b51ca1fbc">n2e2d</a>(imass,imass1)</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   <span class="keywordflow">DO</span> i=1,m </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;     aicetmp(i) = aice(i,1)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="keywordflow">   END DO</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;   aiu =0.0_sp</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="preprocessor"># if defined (MULTIPROCESSOR)</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="preprocessor"></span>       <span class="keywordflow">if</span>(par) <span class="keyword">CALL </span>node_match(1,<a class="code" href="namespacemod__par.html#a79180bf58af0a0e24de12aa8c5b4b21d">nbn</a>,<a class="code" href="namespacemod__par.html#aed65ebed23fd5b188015e8df7c549624">bn_mlt</a>,<a class="code" href="namespacemod__par.html#a7ca332c77f501334fff64fc71f745859">bn_loc</a>,bnc,mt,1,myid,nprocs,aicetmp)</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;       <span class="keywordflow">IF</span>(par) <span class="keyword">CALL </span>aexchange(nc,myid,nprocs,aicetmp)</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   <span class="keyword">CALL </span><a class="code" href="namespaceall__vars.html#ac376e20484e1be61da82494b51ca1fbc">n2e2d</a>(aicetmp,aiu)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;   <span class="keywordflow">DO</span> i=1,n </div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keywordflow">IF</span>(sum(isicen(<a class="code" href="namespaceall__vars.html#a9d3143499e0af831a6e497eb590354ac">nv</a>(i,1:3))) &gt; 0 .and.imass1(i)&gt;p01  &amp;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;         .and. aiu(i)&gt;p001) &amp;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      isicec(i)=1</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="keywordflow">   END DO</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;   <span class="keyword">Deallocate</span>(aicetmp)</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;   <span class="keyword">DEALLOCATE</span>(imass1,imass)</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keyword">call </span>from_coupler        <span class="comment">! get updated info from flux couple</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keyword">Call </span><a class="code" href="namespaceice__therm__vertical.html#a41018c2d1275b4fee13d1d97c7d32298">thermo_vertical</a>     <span class="comment">! thermodynamic growth rates and fluxes</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keyword">call </span>to_coupler          <span class="comment">! collect/send data to flux coupler</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__therm__itd.html#ac614ed7a78a4d1bea6cbedf805e1a4fa">thermo_itd</a>          <span class="comment">! thermodynamics and associated itd changes</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">!!===========================================================================!!</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="preprocessor">#  if defined (ONE_D_MODEL)</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="preprocessor"></span>      <span class="keyword">call </span><a class="code" href="namespaceice__itd.html#a5c431bd25eb67ee3bc2efd90b29450d7">zap_small_areas</a>     <span class="comment">! remove categories with very small areas</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a> &gt; 1) <span class="keyword">call </span><a class="code" href="namespaceice__itd.html#ac6b7ddf46d55f420bf0a7f701a724b5d">rebin</a> <span class="comment">! make sure thicknesses are in bounds</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__itd.html#af934be7228f44bbd21e488aed8e431b3">aggregate</a>           <span class="comment">! aggregate state variables over categories</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__albedo.html#a50f81c9c840048f8ae4fcd55b44aea86">albedos</a>             <span class="comment">! compute ice albedos</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordflow">return</span>                   <span class="comment">! NO advection for spinup run</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="comment">!!  DYNAMICS FOR SEA ICE</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;       <span class="keywordflow">DO</span> kice=1,<a class="code" href="namespaceice__calendar.html#ab9588cbe78aab3d98d16e84542792a4b">ndyn_dt</a>  <span class="comment">!!  sub loop for ice model</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;       <span class="keyword">CALL </span>ice_runge_kutta</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">!!===================================================================</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="comment">! Make sure state variables are not too close to zero.</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__itd.html#ac7eb0f1c8e76a6a35e41095fb76ff4ba">check_state</a></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="comment">! fill work arrays with fields to be advected</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="comment">! two arrays are used for performance (balance memory/cache vs</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="comment">! number of bound calls);  one array or more than two may perform</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="comment">! better depending on the machine used, number of processors, etc.</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="comment">! --tested on SGI R2000, using 4 pes for the ice model under MPI</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <span class="comment">!!================================================================</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      works =0.0_sp</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      worke =0.0_sp</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <span class="keywordflow">do</span> i = 1,<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">do</span> j = 1,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;         works(i,1) = min(max(aice0(i,j),0.0),1.0)</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      narrays = 1</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="keywordflow">do</span> ni=1,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;       <span class="keywordflow">do</span> i = 1,<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;         <span class="keywordflow">do</span> j = 1,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;          <span class="comment">! this is the hice adjust the convergence to hice change</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;             works(i,narrays+1) = aicen(i,j,ni)  </div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;             works(i,narrays+2) = vicen(i,j,ni) </div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;             works(i,narrays+3) = vsnon(i,j,ni) </div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;             works(i,narrays+4) = -aicen(i,j,ni)*tsfcn(i,j,ni) </div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;             works(i,narrays+5) = -(esnon(i,j,ni)   &amp;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                               +rhos*lfresh*vsnon(i,j,ni))   <span class="comment">! for Tsnow&lt;0</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="keywordflow">           enddo</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">!         ! if there were 3 arrays in loop, use 3 instead and change narr</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;         narrays = narrays + 5</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">!-----------------------------------------------------------------------------</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  </div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;     <span class="keywordflow">do</span> k=1,<a class="code" href="namespaceice__model__size.html#aad5690a90b6f7ad823dba09d293ca892">ntilay</a></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">do</span> i = 1,<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;           <span class="keywordflow">do</span> j = 1,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;           worke(i,k) = -eicen(i,j,k)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="keywordflow">           enddo</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="keywordflow">       enddo</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="keywordflow">     enddo</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keywordflow">if</span> (narr /= narrays)  &amp;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;     &amp; <span class="keyword">write</span>(ipt,*) <span class="stringliteral">&quot;Wrong number of arrays in transport bound call&quot;</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">!!--------------------------------------------------------------------------</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;     <span class="keyword">allocate</span>(irbuf(0:mt))</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">!!--------------------------------------------------------------------------</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;     irbuf=0.0_sp</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;     <span class="keywordflow">DO</span> k=1,narr</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;       irbuf(1:m)=works(1:m,k)</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="preprocessor"># if defined (MULTIPROCESSOR)</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="preprocessor"></span>       <span class="keywordflow">if</span> (par) <span class="keyword">CALL </span>node_match(1,<a class="code" href="namespacemod__par.html#a79180bf58af0a0e24de12aa8c5b4b21d">nbn</a>,<a class="code" href="namespacemod__par.html#aed65ebed23fd5b188015e8df7c549624">bn_mlt</a>,<a class="code" href="namespacemod__par.html#a7ca332c77f501334fff64fc71f745859">bn_loc</a>,bnc,mt,1,myid,nprocs,irbuf)</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;       <span class="keywordflow">IF</span> (par) <span class="keyword">CALL </span>aexchange(nc,myid,nprocs,irbuf) </div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;       <span class="keyword">call </span>ice_adv_fvcom(irbuf,uice2,vice2)</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="preprocessor"># if defined (MULTIPROCESSOR)</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor"></span>       <span class="keywordflow">if</span> (par) <span class="keyword">CALL </span>node_match(1,<a class="code" href="namespacemod__par.html#a79180bf58af0a0e24de12aa8c5b4b21d">nbn</a>,<a class="code" href="namespacemod__par.html#aed65ebed23fd5b188015e8df7c549624">bn_mlt</a>,<a class="code" href="namespacemod__par.html#a7ca332c77f501334fff64fc71f745859">bn_loc</a>,bnc,mt,1,myid,nprocs,irbuf)</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;       <span class="keywordflow">IF</span> (par) <span class="keyword">CALL </span>aexchange(nc,myid,nprocs,irbuf) </div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="preprocessor"></span>       works(1:m,k)=irbuf(1:m)</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="keywordflow">     END DO</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">!!--------------------------------------------------------------------------</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;     irbuf=0.0_sp</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;     <span class="keywordflow">do</span> k=1,<a class="code" href="namespaceice__model__size.html#aad5690a90b6f7ad823dba09d293ca892">ntilay</a></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;     irbuf(1:m)=worke(1:m,k)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="preprocessor"># if defined (MULTIPROCESSOR)</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="preprocessor"></span>       <span class="keywordflow">IF</span> (par) <span class="keyword">CALL </span>node_match(1,<a class="code" href="namespacemod__par.html#a79180bf58af0a0e24de12aa8c5b4b21d">nbn</a>,<a class="code" href="namespacemod__par.html#aed65ebed23fd5b188015e8df7c549624">bn_mlt</a>,<a class="code" href="namespacemod__par.html#a7ca332c77f501334fff64fc71f745859">bn_loc</a>,bnc,mt,1,myid,nprocs,irbuf)</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;       <span class="keywordflow">IF</span> (par) <span class="keyword">CALL </span>aexchange(nc,myid,nprocs,irbuf) </div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;       <span class="keyword">call </span>ice_adv_fvcom(irbuf,uice2,vice2)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="preprocessor"># if defined (MULTIPROCESSOR)</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="preprocessor"></span>       <span class="keywordflow">IF</span> (par) <span class="keyword">CALL </span>node_match(1,<a class="code" href="namespacemod__par.html#a79180bf58af0a0e24de12aa8c5b4b21d">nbn</a>,<a class="code" href="namespacemod__par.html#aed65ebed23fd5b188015e8df7c549624">bn_mlt</a>,<a class="code" href="namespacemod__par.html#a7ca332c77f501334fff64fc71f745859">bn_loc</a>,bnc,mt,1,myid,nprocs,irbuf)</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;       <span class="keywordflow">IF</span> (par) <span class="keyword">CALL </span>aexchange(nc,myid,nprocs,irbuf) </div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="preprocessor"></span>      worke(1:m,k)=irbuf(1:m)</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="keywordflow">      end do</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keyword">deallocate</span>(irbuf)</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">!!==========================================================================</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="comment">! retrieve advected fields from work array</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="comment">!-----------------------------------------------------------------</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">do</span> i = 1,<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;          <span class="keywordflow">do</span> j = 1,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;          aice0(i,j) = min(max(works(i,1),c0i),c1i)</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      narrays = 1               <span class="comment">! aice0 is first array</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keywordflow">do</span> ni=1,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">do</span> i = 1,<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;           <span class="keywordflow">do</span> j = 1,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;              aicen(i,j,ni) = min(max(works(i,narrays+1),c0i),c1i)</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;              vicen(i,j,ni) = works(i,narrays+2) </div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;             <span class="keywordflow">if</span> ((aicen(i,j,ni)&lt;puny .or.vicen(i,j,ni) &lt; puny))<span class="keywordflow">then</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                 aicen(i,j,ni)=0.0</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                 vicen(i,j,ni)=0.0</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="keywordflow">             endif</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;              vsnon(i,j,ni) = works(i,narrays+3) </div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;             <span class="keywordflow">if</span> (vsnon(i,j,ni) &lt; puny) vsnon(i,j,ni) =0.0_sp</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;             <span class="keywordflow">if</span> (aicen(i,j,ni) &gt; puny) <span class="keywordflow">then</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;               tsfcn(i,j,ni) = -works(i,narrays+4)/aicen(i,j,ni)</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;             <span class="keywordflow">else</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                tsfcn(i,j,ni) = tf(i,j)</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="keywordflow">             endif</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;             <span class="keywordflow">if</span> (aicen(i,j,ni) &gt; puny) &amp;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;             esnon(i,j,ni) = -works(i,narrays+5)  &amp;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;     &amp;                       -rhos*lfresh*vsnon(i,j,ni) <span class="comment">! for Tsnow&lt;0</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="keywordflow">           enddo</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;         narrays = narrays + 5</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      j=1</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <span class="keywordflow">do</span> i = 1,<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          <span class="keywordflow">do</span> ni=1,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;           <span class="comment">!IF(Tsfcn(i,j,ni) .le.T_air(I)) Tsfcn(i,j,ni) =T_air(i)</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;       <span class="comment">!=============================================================================</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <span class="keywordflow">do</span> k=1,<a class="code" href="namespaceice__model__size.html#aad5690a90b6f7ad823dba09d293ca892">ntilay</a></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keywordflow">do</span> i=1,<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;         <span class="keywordflow">do</span> j=1,<a class="code" href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">jmt_local</a></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;             eicen(i,j,k) = -worke(i,k)</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;150     <span class="keywordflow">continue</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__itd.html#ac7eb0f1c8e76a6a35e41095fb76ff4ba">check_state</a></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;     <span class="keyword">call </span><a class="code" href="namespaceice__itd.html#af934be7228f44bbd21e488aed8e431b3">aggregate</a>           <span class="comment">! aggregate state variables over categories</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      j=1</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordflow">do</span> i = 1,<a class="code" href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">imt_local</a></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;         <span class="keywordflow">IF</span> (aice(i,j) &gt; 1.0)<span class="keywordflow">then</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;         <span class="keywordflow">do</span> ni=1,<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;             aicen(i,j,ni) = aicen(i,j,ni)/aice(i,j)</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;             vicen(i,j,ni) = vicen(i,j,ni)/aice(i,j)</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;             vsnon(i,j,ni) = vsnon(i,j,ni)/aice(i,j)</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;             esnon(i,j,ni) = esnon(i,j,ni)/aice(i,j)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;         <span class="keywordflow">do</span> k = 1, <a class="code" href="namespaceice__model__size.html#afba05a44dfbbe3c640138d47f1029dbd">nilyr</a></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;             eicen(i,j,ilyr1(ni)+k-1) =eicen(i,j,ilyr1(ni)+k-1)/aice(i,j)</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="keywordflow">         end do</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;         aice0(i,j)=0.0</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;         aice(i,j)=1.0</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="keywordflow">         END IF</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;     <span class="keyword">call </span><a class="code" href="namespaceice__mechred.html#a56b4d95edf6adf014f520c81b5128e95">ridge_ice</a>(delta,divu) <span class="comment">! ridging</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="keywordflow">      ENDDO</span>  <span class="comment">!! KTICE  sub loop for ice dynamics</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__itd.html#a5c431bd25eb67ee3bc2efd90b29450d7">zap_small_areas</a>     <span class="comment">! remove categories with very small areas</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ncat</a> &gt; 1) <span class="keyword">call </span><a class="code" href="namespaceice__itd.html#ac6b7ddf46d55f420bf0a7f701a724b5d">rebin</a> <span class="comment">! make sure thicknesses are in bounds</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__itd.html#af934be7228f44bbd21e488aed8e431b3">aggregate</a>           <span class="comment">! aggregate state variables over categories</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceice__albedo.html#a50f81c9c840048f8ae4fcd55b44aea86">albedos</a>             <span class="comment">! compute ice albedos</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keywordflow">IF</span>(<a class="code" href="namespacemod__utils.html#af4d60bccc1216e0c740fcefc0674ef9b">dbg_set</a>(<a class="code" href="namespacemod__utils.html#a60e94d6abe4ceab6a20f4e569a826bea">dbg_sbr</a>)) <span class="keyword">WRITE</span>(ipt,*) <span class="stringliteral">&quot;END ICE_1d_2d&quot;</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;       <span class="keywordflow">return</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="keyword">       end subroutine </span>ice_1d_2d</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">!=======================================================================!</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacemod__ice.html">mod_ice</a></div><div class="ttc" id="namespacemod__par_html_a79180bf58af0a0e24de12aa8c5b4b21d"><div class="ttname"><a href="namespacemod__par.html#a79180bf58af0a0e24de12aa8c5b4b21d">mod_par::nbn</a></div><div class="ttdeci">integer nbn</div><div class="ttdef"><b>Definition:</b> <a href="mod__par_8F_source.html#l00065">mod_par.F:65</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_a606c65768776f4e8eb121119660e0459"><div class="ttname"><a href="namespaceice__mechred.html#a606c65768776f4e8eb121119660e0459">ice_mechred::krdg</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:,:), allocatable, save krdg</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00132">ice_mechred.F:132</a></div></div>
<div class="ttc" id="namespaceice__model__size_html_afba05a44dfbbe3c640138d47f1029dbd"><div class="ttname"><a href="namespaceice__model__size.html#afba05a44dfbbe3c640138d47f1029dbd">ice_model_size::nilyr</a></div><div class="ttdeci">integer(kind=int_kind), parameter nilyr</div><div class="ttdef"><b>Definition:</b> <a href="ice__model__size_8F_source.html#l00038">ice_model_size.F:38</a></div></div>
<div class="ttc" id="namespaceice__flux_html_af7638513b5af246df1a6e59cf17ca1f5"><div class="ttname"><a href="namespaceice__flux.html#af7638513b5af246df1a6e59cf17ca1f5">ice_flux::lhcoef</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save lhcoef</div><div class="ttdef"><b>Definition:</b> <a href="ice__flux_8F_source.html#l00153">ice_flux.F:153</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a8072fea2c4f14e498f4ae52593d35f84"><div class="ttname"><a href="namespaceall__vars.html#a8072fea2c4f14e498f4ae52593d35f84">all_vars::qprec</a></div><div class="ttdeci">real(sp), dimension(:), allocatable, target qprec</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01306">mod_main.F:1306</a></div></div>
<div class="ttc" id="namespaceice__albedo_html_ad9b38d68b853035f07dc72db82e5625d"><div class="ttname"><a href="namespaceice__albedo.html#ad9b38d68b853035f07dc72db82e5625d">ice_albedo::alidrn</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:,:), allocatable, save alidrn</div><div class="ttdef"><b>Definition:</b> <a href="ice__albedo_8F_source.html#l00065">ice_albedo.F:65</a></div></div>
<div class="ttc" id="namespacemod__utils_html"><div class="ttname"><a href="namespacemod__utils.html">mod_utils</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__utils_8F_source.html#l00029">mod_utils.F:29</a></div></div>
<div class="ttc" id="namespaceice__flux__in_html_ae31f4e72ab0b4d8994f234255e402ceb"><div class="ttname"><a href="namespaceice__flux__in.html#ae31f4e72ab0b4d8994f234255e402ceb">ice_flux_in::cldf</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save cldf</div><div class="ttdef"><b>Definition:</b> <a href="ice__flux__in_8F_source.html#l00049">ice_flux_in.F:49</a></div></div>
<div class="ttc" id="namespaceice__init_html"><div class="ttname"><a href="namespaceice__init.html">ice_init</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__init_8F_source.html#l00024">ice_init.F:24</a></div></div>
<div class="ttc" id="namespaceice__scaling_html"><div class="ttname"><a href="namespaceice__scaling.html">ice_scaling</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__scaling_8F_source.html#l00024">ice_scaling.F:24</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_a47985e25a395ebe3fc3fa2b937cd8f5c"><div class="ttname"><a href="namespaceice__mechred.html#a47985e25a395ebe3fc3fa2b937cd8f5c">ice_mechred::apartic</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:,:), allocatable, save apartic</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00127">ice_mechred.F:127</a></div></div>
<div class="ttc" id="namespaceice__therm__itd_html_ac614ed7a78a4d1bea6cbedf805e1a4fa"><div class="ttname"><a href="namespaceice__therm__itd.html#ac614ed7a78a4d1bea6cbedf805e1a4fa">ice_therm_itd::thermo_itd</a></div><div class="ttdeci">subroutine thermo_itd</div><div class="ttdef"><b>Definition:</b> <a href="ice__therm__itd_8F_source.html#l00085">ice_therm_itd.F:85</a></div></div>
<div class="ttc" id="namespaceall__vars_html_ac38b16a30aa51c0a98e2fbb193ad8967"><div class="ttname"><a href="namespaceall__vars.html#ac38b16a30aa51c0a98e2fbb193ad8967">all_vars::qevap2</a></div><div class="ttdeci">real(sp), dimension(:), allocatable, target qevap2</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01304">mod_main.F:1304</a></div></div>
<div class="ttc" id="namespacemod__utils_html_af4d60bccc1216e0c740fcefc0674ef9b"><div class="ttname"><a href="namespacemod__utils.html#af4d60bccc1216e0c740fcefc0674ef9b">mod_utils::dbg_set</a></div><div class="ttdeci">logical function dbg_set(vrb)</div><div class="ttdef"><b>Definition:</b> <a href="mod__utils_8F_source.html#l00179">mod_utils.F:179</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_aaa9bebb0223bfa644c93c1b2dda5d672"><div class="ttname"><a href="namespaceice__mechred.html#aaa9bebb0223bfa644c93c1b2dda5d672">ice_mechred::dvirdgdt</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save dvirdgdt</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00109">ice_mechred.F:109</a></div></div>
<div class="ttc" id="namespaceice__therm__vertical_html_a32cc1b09ad18aff12334d37bd062dbd5"><div class="ttname"><a href="namespaceice__therm__vertical.html#a32cc1b09ad18aff12334d37bd062dbd5">ice_therm_vertical::hicen_old</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:,:), allocatable, save hicen_old</div><div class="ttdef"><b>Definition:</b> <a href="ice__therm__vertical_8F_source.html#l00070">ice_therm_vertical.F:70</a></div></div>
<div class="ttc" id="namespaceice__albedo_html_a38b8c8014dac676816f21a64874ea928"><div class="ttname"><a href="namespaceice__albedo.html#a38b8c8014dac676816f21a64874ea928">ice_albedo::alidf</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save alidf</div><div class="ttdef"><b>Definition:</b> <a href="ice__albedo_8F_source.html#l00072">ice_albedo.F:72</a></div></div>
<div class="ttc" id="namespaceice__domain_html_a52a6c48dfb17144c46b6b414129a6940"><div class="ttname"><a href="namespaceice__domain.html#a52a6c48dfb17144c46b6b414129a6940">ice_domain::ihi</a></div><div class="ttdeci">integer(kind=int_kind) ihi</div><div class="ttdef"><b>Definition:</b> <a href="ice__domain_8F_source.html#l00095">ice_domain.F:95</a></div></div>
<div class="ttc" id="namespaceice__flux__in_html"><div class="ttname"><a href="namespaceice__flux__in.html">ice_flux_in</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__flux__in_8F_source.html#l00025">ice_flux_in.F:25</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a8879771294c6ba010ba590466d1b3980"><div class="ttname"><a href="namespaceall__vars.html#a8879771294c6ba010ba590466d1b3980">all_vars::t1</a></div><div class="ttdeci">real(sp), dimension(:,:), allocatable, target t1</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01414">mod_main.F:1414</a></div></div>
<div class="ttc" id="namespaceice__flux_html_a5b30de4b43f8bb404bb4c79ae2ee9ff2"><div class="ttname"><a href="namespaceice__flux.html#a5b30de4b43f8bb404bb4c79ae2ee9ff2">ice_flux::fsw</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save fsw</div><div class="ttdef"><b>Definition:</b> <a href="ice__flux_8F_source.html#l00153">ice_flux.F:153</a></div></div>
<div class="ttc" id="namespaceice__itd_html_a2c5da98ae0797cd69f98ffce134e4ef7"><div class="ttname"><a href="namespaceice__itd.html#a2c5da98ae0797cd69f98ffce134e4ef7">ice_itd::init_itd</a></div><div class="ttdeci">subroutine init_itd</div><div class="ttdef"><b>Definition:</b> <a href="ice__itd_8F_source.html#l00101">ice_itd.F:101</a></div></div>
<div class="ttc" id="namespaceice__grid_html_a1cf208d9fa47e12e370c5d279f005003"><div class="ttname"><a href="namespaceice__grid.html#a1cf208d9fa47e12e370c5d279f005003">ice_grid::ulon</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable ulon</div><div class="ttdef"><b>Definition:</b> <a href="ice__grid_8F_source.html#l00111">ice_grid.F:111</a></div></div>
<div class="ttc" id="namespaceice__grid_html_a78ed074def6a04bfa70db90aafb82969"><div class="ttname"><a href="namespaceice__grid.html#a78ed074def6a04bfa70db90aafb82969">ice_grid::tlat</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable tlat</div><div class="ttdef"><b>Definition:</b> <a href="ice__grid_8F_source.html#l00111">ice_grid.F:111</a></div></div>
<div class="ttc" id="namespaceice__therm__itd_html"><div class="ttname"><a href="namespaceice__therm__itd.html">ice_therm_itd</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__therm__itd_8F_source.html#l00034">ice_therm_itd.F:34</a></div></div>
<div class="ttc" id="namespacemod__par_html_aed65ebed23fd5b188015e8df7c549624"><div class="ttname"><a href="namespacemod__par.html#aed65ebed23fd5b188015e8df7c549624">mod_par::bn_mlt</a></div><div class="ttdeci">integer, dimension(:), pointer bn_mlt</div><div class="ttdef"><b>Definition:</b> <a href="mod__par_8F_source.html#l00069">mod_par.F:69</a></div></div>
<div class="ttc" id="namespaceice__itd_html_ac7eb0f1c8e76a6a35e41095fb76ff4ba"><div class="ttname"><a href="namespaceice__itd.html#ac7eb0f1c8e76a6a35e41095fb76ff4ba">ice_itd::check_state</a></div><div class="ttdeci">subroutine check_state</div><div class="ttdef"><b>Definition:</b> <a href="ice__itd_8F_source.html#l00518">ice_itd.F:518</a></div></div>
<div class="ttc" id="namespaceice__therm__vertical_html_a1123b2b5ee24c8b82a26c5a831c88405"><div class="ttname"><a href="namespaceice__therm__vertical.html#a1123b2b5ee24c8b82a26c5a831c88405">ice_therm_vertical::init_thermo_vertical</a></div><div class="ttdeci">subroutine init_thermo_vertical</div><div class="ttdef"><b>Definition:</b> <a href="ice__therm__vertical_8F_source.html#l00103">ice_therm_vertical.F:103</a></div></div>
<div class="ttc" id="namespaceice__grid_html"><div class="ttname"><a href="namespaceice__grid.html">ice_grid</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__grid_8F_source.html#l00024">ice_grid.F:24</a></div></div>
<div class="ttc" id="namespacemod__par_html"><div class="ttname"><a href="namespacemod__par.html">mod_par</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__par_8F_source.html#l00030">mod_par.F:30</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_af2d6fe75b6f2cddc121139c198838c34"><div class="ttname"><a href="namespaceice__mechred.html#af2d6fe75b6f2cddc121139c198838c34">ice_mechred::opening</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save opening</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00109">ice_mechred.F:109</a></div></div>
<div class="ttc" id="namespaceice__grid_html_ac003a32baa0ed51dccd612e4637ed535"><div class="ttname"><a href="namespaceice__grid.html#ac003a32baa0ed51dccd612e4637ed535">ice_grid::ulat</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable ulat</div><div class="ttdef"><b>Definition:</b> <a href="ice__grid_8F_source.html#l00111">ice_grid.F:111</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_a7574477bf6f9a45d9c5d580340a7f72c"><div class="ttname"><a href="namespaceice__mechred.html#a7574477bf6f9a45d9c5d580340a7f72c">ice_mechred::dardg1dt</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save dardg1dt</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00109">ice_mechred.F:109</a></div></div>
<div class="ttc" id="namespaceice__albedo_html_adb52e20b41821d68863101b9d8b68c73"><div class="ttname"><a href="namespaceice__albedo.html#adb52e20b41821d68863101b9d8b68c73">ice_albedo::alvdr</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save alvdr</div><div class="ttdef"><b>Definition:</b> <a href="ice__albedo_8F_source.html#l00072">ice_albedo.F:72</a></div></div>
<div class="ttc" id="namespaceall__vars_html_ae96b4b252fe0654986c9565b881600e7"><div class="ttname"><a href="namespaceall__vars.html#ae96b4b252fe0654986c9565b881600e7">all_vars::s1</a></div><div class="ttdeci">real(sp), dimension(:,:), allocatable, target s1</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01415">mod_main.F:1415</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_a799f453ee13595354d631bbe7204cef1"><div class="ttname"><a href="namespaceice__mechred.html#a799f453ee13595354d631bbe7204cef1">ice_mechred::aksum</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save aksum</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00122">ice_mechred.F:122</a></div></div>
<div class="ttc" id="namespaceice__domain_html_a765ced183baf4243806f297b8d0c02c5"><div class="ttname"><a href="namespaceice__domain.html#a765ced183baf4243806f297b8d0c02c5">ice_domain::jlo</a></div><div class="ttdeci">integer(kind=int_kind) jlo</div><div class="ttdef"><b>Definition:</b> <a href="ice__domain_8F_source.html#l00095">ice_domain.F:95</a></div></div>
<div class="ttc" id="namespaceice__atmo_html_ac4d5d2b9675d614e780ff2ceef534c4a"><div class="ttname"><a href="namespaceice__atmo.html#ac4d5d2b9675d614e780ff2ceef534c4a">ice_atmo::atmo_boundary_layer</a></div><div class="ttdeci">subroutine atmo_boundary_layer(ni, sfctype, Tsf,                                                                                                                                                   strx, stry, Trf, Qrf, delt, delq)</div><div class="ttdef"><b>Definition:</b> <a href="ice__atmo_8F_source.html#l00051">ice_atmo.F:51</a></div></div>
<div class="ttc" id="namespaceice__flux__in_html_aa4efb0fb0043cffafb7436fe6cbdad12"><div class="ttname"><a href="namespaceice__flux__in.html#aa4efb0fb0043cffafb7436fe6cbdad12">ice_flux_in::prepare_forcing</a></div><div class="ttdeci">subroutine prepare_forcing</div><div class="ttdef"><b>Definition:</b> <a href="ice__flux__in_8F_source.html#l01202">ice_flux_in.F:1202</a></div></div>
<div class="ttc" id="namespaceice__albedo_html_a9ddfa8d4d70600cf1a99d17be4e3254f"><div class="ttname"><a href="namespaceice__albedo.html#a9ddfa8d4d70600cf1a99d17be4e3254f">ice_albedo::alvdf</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save alvdf</div><div class="ttdef"><b>Definition:</b> <a href="ice__albedo_8F_source.html#l00072">ice_albedo.F:72</a></div></div>
<div class="ttc" id="namespaceice__albedo_html_a5f9b8615897813e81ac516d22ba1fdb1"><div class="ttname"><a href="namespaceice__albedo.html#a5f9b8615897813e81ac516d22ba1fdb1">ice_albedo::albocn</a></div><div class="ttdeci">real(kind=dbl_kind), parameter albocn</div><div class="ttdef"><b>Definition:</b> <a href="ice__albedo_8F_source.html#l00037">ice_albedo.F:37</a></div></div>
<div class="ttc" id="namespaceall__vars_html_ac02f56f584500f6ae8d3d6e321ba3732"><div class="ttname"><a href="namespaceall__vars.html#ac02f56f584500f6ae8d3d6e321ba3732">all_vars::swrad</a></div><div class="ttdeci">real(sp), dimension(:), allocatable, target swrad</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01244">mod_main.F:1244</a></div></div>
<div class="ttc" id="namespaceice__calendar_html_ab9588cbe78aab3d98d16e84542792a4b"><div class="ttname"><a href="namespaceice__calendar.html#ab9588cbe78aab3d98d16e84542792a4b">ice_calendar::ndyn_dt</a></div><div class="ttdeci">integer(kind=int_kind) ndyn_dt</div><div class="ttdef"><b>Definition:</b> <a href="ice__calendar_8F_source.html#l00044">ice_calendar.F:44</a></div></div>
<div class="ttc" id="namespaceice__grid_html_a07f851c9a83f3e03a4ada92b12812721"><div class="ttname"><a href="namespaceice__grid.html#a07f851c9a83f3e03a4ada92b12812721">ice_grid::init_grid</a></div><div class="ttdeci">subroutine init_grid</div><div class="ttdef"><b>Definition:</b> <a href="ice__grid_8F_source.html#l00180">ice_grid.F:180</a></div></div>
<div class="ttc" id="namespaceice__mechred_html"><div class="ttname"><a href="namespaceice__mechred.html">ice_mechred</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00047">ice_mechred.F:47</a></div></div>
<div class="ttc" id="namespaceice__therm__itd_html_a85a7a88cd7fd0cadde2cd9d9b8c28635"><div class="ttname"><a href="namespaceice__therm__itd.html#a85a7a88cd7fd0cadde2cd9d9b8c28635">ice_therm_itd::hicen</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:,:), allocatable, save hicen</div><div class="ttdef"><b>Definition:</b> <a href="ice__therm__itd_8F_source.html#l00055">ice_therm_itd.F:55</a></div></div>
<div class="ttc" id="namespaceice__albedo_html_ad45ba52937dca1be56bd7f9fed1d4644"><div class="ttname"><a href="namespaceice__albedo.html#ad45ba52937dca1be56bd7f9fed1d4644">ice_albedo::alidfn</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:,:), allocatable, save alidfn</div><div class="ttdef"><b>Definition:</b> <a href="ice__albedo_8F_source.html#l00065">ice_albedo.F:65</a></div></div>
<div class="ttc" id="namespaceice__albedo_html_a4d6a16f09a94a469c8770621857cde64"><div class="ttname"><a href="namespaceice__albedo.html#a4d6a16f09a94a469c8770621857cde64">ice_albedo::alvdrn</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:,:), allocatable, save alvdrn</div><div class="ttdef"><b>Definition:</b> <a href="ice__albedo_8F_source.html#l00065">ice_albedo.F:65</a></div></div>
<div class="ttc" id="namespaceice__domain_html_a778eb962693206021728e3eeb5e8b5db"><div class="ttname"><a href="namespaceice__domain.html#a778eb962693206021728e3eeb5e8b5db">ice_domain::ilo</a></div><div class="ttdeci">integer(kind=int_kind) ilo</div><div class="ttdef"><b>Definition:</b> <a href="ice__domain_8F_source.html#l00095">ice_domain.F:95</a></div></div>
<div class="ttc" id="namespacemod__ice_html"><div class="ttname"><a href="namespacemod__ice.html">mod_ice</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__ice_8F_source.html#l00042">mod_ice.F:42</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a45fa8cb66444fb18eb86a299cd9425c7"><div class="ttname"><a href="namespaceall__vars.html#a45fa8cb66444fb18eb86a299cd9425c7">all_vars::ntve</a></div><div class="ttdeci">integer, dimension(:), allocatable, target ntve</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01078">mod_main.F:1078</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_a7d3d24ef19a969cfbda15b9816c40ddd"><div class="ttname"><a href="namespaceice__mechred.html#a7d3d24ef19a969cfbda15b9816c40ddd">ice_mechred::hrmin</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:,:), allocatable, save hrmin</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00132">ice_mechred.F:132</a></div></div>
<div class="ttc" id="namespaceice__domain_html_a0b79cf51749eb65b41a3819e2d6de8a2"><div class="ttname"><a href="namespaceice__domain.html#a0b79cf51749eb65b41a3819e2d6de8a2">ice_domain::jhi</a></div><div class="ttdeci">integer(kind=int_kind) jhi</div><div class="ttdef"><b>Definition:</b> <a href="ice__domain_8F_source.html#l00095">ice_domain.F:95</a></div></div>
<div class="ttc" id="namespaceice__domain_html"><div class="ttname"><a href="namespaceice__domain.html">ice_domain</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__domain_8F_source.html#l00025">ice_domain.F:25</a></div></div>
<div class="ttc" id="namespaceice__work_html"><div class="ttname"><a href="namespaceice__work.html">ice_work</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__work_8F_source.html#l00027">ice_work.F:27</a></div></div>
<div class="ttc" id="namespaceice__work_html_a332295fcdafb79aaea5e8cfc26213d5e"><div class="ttname"><a href="namespaceice__work.html#a332295fcdafb79aaea5e8cfc26213d5e">ice_work::worka</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable worka</div><div class="ttdef"><b>Definition:</b> <a href="ice__work_8F_source.html#l00050">ice_work.F:50</a></div></div>
<div class="ttc" id="namespaceice__albedo_html_a50f81c9c840048f8ae4fcd55b44aea86"><div class="ttname"><a href="namespaceice__albedo.html#a50f81c9c840048f8ae4fcd55b44aea86">ice_albedo::albedos</a></div><div class="ttdeci">subroutine albedos</div><div class="ttdef"><b>Definition:</b> <a href="ice__albedo_8F_source.html#l00098">ice_albedo.F:98</a></div></div>
<div class="ttc" id="namespaceice__atmo_html"><div class="ttname"><a href="namespaceice__atmo.html">ice_atmo</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__atmo_8F_source.html#l00025">ice_atmo.F:25</a></div></div>
<div class="ttc" id="namespaceice__calendar_html"><div class="ttname"><a href="namespaceice__calendar.html">ice_calendar</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__calendar_8F_source.html#l00024">ice_calendar.F:24</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a9d3143499e0af831a6e497eb590354ac"><div class="ttname"><a href="namespaceall__vars.html#a9d3143499e0af831a6e497eb590354ac">all_vars::nv</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, target nv</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01074">mod_main.F:1074</a></div></div>
<div class="ttc" id="namespaceice__itd__linear_html"><div class="ttname"><a href="namespaceice__itd__linear.html">ice_itd_linear</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__itd__linear_8F_source.html#l00029">ice_itd_linear.F:29</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a86b299505f5be46e717242940c79ea50"><div class="ttname"><a href="namespaceall__vars.html#a86b299505f5be46e717242940c79ea50">all_vars::n_icellq</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, target n_icellq</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01283">mod_main.F:1283</a></div></div>
<div class="ttc" id="namespaceice__kinds__mod_html"><div class="ttname"><a href="namespaceice__kinds__mod.html">ice_kinds_mod</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__kinds__mod_8F_source.html#l00025">ice_kinds_mod.F:25</a></div></div>
<div class="ttc" id="namespaceice__model__size_html_a5515e2fc8bb19a804d698a093d5f6eba"><div class="ttname"><a href="namespaceice__model__size.html#a5515e2fc8bb19a804d698a093d5f6eba">ice_model_size::ncat</a></div><div class="ttdeci">integer(kind=int_kind), parameter ncat</div><div class="ttdef"><b>Definition:</b> <a href="ice__model__size_8F_source.html#l00038">ice_model_size.F:38</a></div></div>
<div class="ttc" id="namespaceice__work_html_a6dbc3fc4e0de1fec11e796800ad56a08"><div class="ttname"><a href="namespaceice__work.html#a6dbc3fc4e0de1fec11e796800ad56a08">ice_work::work_l2</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable work_l2</div><div class="ttdef"><b>Definition:</b> <a href="ice__work_8F_source.html#l00050">ice_work.F:50</a></div></div>
<div class="ttc" id="namespaceall__vars_html_ac376e20484e1be61da82494b51ca1fbc"><div class="ttname"><a href="namespaceall__vars.html#ac376e20484e1be61da82494b51ca1fbc">all_vars::n2e2d</a></div><div class="ttdeci">subroutine n2e2d(NVAR, EVAR)</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01519">mod_main.F:1519</a></div></div>
<div class="ttc" id="namespaceice__albedo_html_a4995ff7773a3e9f9a4d7ce3b4f490eca"><div class="ttname"><a href="namespaceice__albedo.html#a4995ff7773a3e9f9a4d7ce3b4f490eca">ice_albedo::alidr</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save alidr</div><div class="ttdef"><b>Definition:</b> <a href="ice__albedo_8F_source.html#l00072">ice_albedo.F:72</a></div></div>
<div class="ttc" id="namespaceall__vars_html_ad0806891c01947edc17e4e4d081c12e3"><div class="ttname"><a href="namespaceall__vars.html#ad0806891c01947edc17e4e4d081c12e3">all_vars::qevap</a></div><div class="ttdeci">real(sp), dimension(:), allocatable, target qevap</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01307">mod_main.F:1307</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a40b9f762b932c81996806be8a1bea937"><div class="ttname"><a href="namespaceall__vars.html#a40b9f762b932c81996806be8a1bea937">all_vars::dz</a></div><div class="ttdeci">real(sp), dimension(:,:), allocatable, target dz</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01159">mod_main.F:1159</a></div></div>
<div class="ttc" id="namespaceice__domain_html_a9a7d467657702c4668fc81966246b1da"><div class="ttname"><a href="namespaceice__domain.html#a9a7d467657702c4668fc81966246b1da">ice_domain::index_global</a></div><div class="ttdeci">integer(kind=int_kind), dimension(:,:), allocatable, save index_global</div><div class="ttdef"><b>Definition:</b> <a href="ice__domain_8F_source.html#l00078">ice_domain.F:78</a></div></div>
<div class="ttc" id="namespaceall__vars_html"><div class="ttname"><a href="namespaceall__vars.html">all_vars</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01015">mod_main.F:1015</a></div></div>
<div class="ttc" id="namespaceice__itd_html_ac6b7ddf46d55f420bf0a7f701a724b5d"><div class="ttname"><a href="namespaceice__itd.html#ac6b7ddf46d55f420bf0a7f701a724b5d">ice_itd::rebin</a></div><div class="ttdeci">subroutine rebin</div><div class="ttdef"><b>Definition:</b> <a href="ice__itd_8F_source.html#l00615">ice_itd.F:615</a></div></div>
<div class="ttc" id="namespaceice__domain_html_abdbb026511410be56e5b49095579bf15"><div class="ttname"><a href="namespaceice__domain.html#abdbb026511410be56e5b49095579bf15">ice_domain::my_task</a></div><div class="ttdeci">integer(kind=int_kind), save my_task</div><div class="ttdef"><b>Definition:</b> <a href="ice__domain_8F_source.html#l00089">ice_domain.F:89</a></div></div>
<div class="ttc" id="namespaceice__domain_html_a679765d847b3df319a70834fff73b5c1"><div class="ttname"><a href="namespaceice__domain.html#a679765d847b3df319a70834fff73b5c1">ice_domain::imt_local</a></div><div class="ttdeci">integer(kind=int_kind) imt_local</div><div class="ttdef"><b>Definition:</b> <a href="ice__domain_8F_source.html#l00095">ice_domain.F:95</a></div></div>
<div class="ttc" id="namespaceice__flux__in_html_ad3300da51a0b8d4d6d51723d593ac9a4"><div class="ttname"><a href="namespaceice__flux__in.html#ad3300da51a0b8d4d6d51723d593ac9a4">ice_flux_in::init_getflux</a></div><div class="ttdeci">subroutine init_getflux</div><div class="ttdef"><b>Definition:</b> <a href="ice__flux__in_8F_source.html#l00131">ice_flux_in.F:131</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a81e289fe52a66153857f91780db643e3"><div class="ttname"><a href="namespaceall__vars.html#a81e289fe52a66153857f91780db643e3">all_vars::icellq</a></div><div class="ttdeci">integer, dimension(:), allocatable, target icellq</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01282">mod_main.F:1282</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_a56b4d95edf6adf014f520c81b5128e95"><div class="ttname"><a href="namespaceice__mechred.html#a56b4d95edf6adf014f520c81b5128e95">ice_mechred::ridge_ice</a></div><div class="ttdeci">subroutine ridge_ice(Delta, divu)</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00200">ice_mechred.F:200</a></div></div>
<div class="ttc" id="namespaceice__fileunits_html"><div class="ttname"><a href="namespaceice__fileunits.html">ice_fileunits</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__fileunits_8F_source.html#l00024">ice_fileunits.F:24</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_a5924a79b0e0709252101fa8b6be1f3c8"><div class="ttname"><a href="namespaceice__mechred.html#a5924a79b0e0709252101fa8b6be1f3c8">ice_mechred::hrexp</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:,:), allocatable, save hrexp</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00132">ice_mechred.F:132</a></div></div>
<div class="ttc" id="namespaceall__vars_html_ad42856b79f21ee239a519a1ecc20c8e8"><div class="ttname"><a href="namespaceall__vars.html#ad42856b79f21ee239a519a1ecc20c8e8">all_vars::nbve</a></div><div class="ttdeci">integer, dimension(:,:), allocatable, target nbve</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01090">mod_main.F:1090</a></div></div>
<div class="ttc" id="namespaceice__flux_html_ab881ac593bc7b8b51e393ebcd241cfaa"><div class="ttname"><a href="namespaceice__flux.html#ab881ac593bc7b8b51e393ebcd241cfaa">ice_flux::shcoef</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save shcoef</div><div class="ttdef"><b>Definition:</b> <a href="ice__flux_8F_source.html#l00153">ice_flux.F:153</a></div></div>
<div class="ttc" id="namespaceice__grid_html_a86bf5bfb68fae14effe3893614dfc6ae"><div class="ttname"><a href="namespaceice__grid.html#a86bf5bfb68fae14effe3893614dfc6ae">ice_grid::hm</a></div><div class="ttdeci">real(kind=dbl_kind), dimension (:,:), allocatable hm</div><div class="ttdef"><b>Definition:</b> <a href="ice__grid_8F_source.html#l00147">ice_grid.F:147</a></div></div>
<div class="ttc" id="namespacemod__obcs_html"><div class="ttname"><a href="namespacemod__obcs.html">mod_obcs</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__obcs_8F_source.html#l00051">mod_obcs.F:51</a></div></div>
<div class="ttc" id="namespaceice__domain_html_ad18f5f3372d9364a7ed17827dc9d0bdd"><div class="ttname"><a href="namespaceice__domain.html#ad18f5f3372d9364a7ed17827dc9d0bdd">ice_domain::rndex_global</a></div><div class="ttdeci">integer(kind=int_kind), dimension(:,:), allocatable, save rndex_global</div><div class="ttdef"><b>Definition:</b> <a href="ice__domain_8F_source.html#l00086">ice_domain.F:86</a></div></div>
<div class="ttc" id="namespaceice__work_html_a882c804b3549d9c719d525ff826ba621"><div class="ttname"><a href="namespaceice__work.html#a882c804b3549d9c719d525ff826ba621">ice_work::workb</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable workb</div><div class="ttdef"><b>Definition:</b> <a href="ice__work_8F_source.html#l00050">ice_work.F:50</a></div></div>
<div class="ttc" id="namespaceall__vars_html_ae411c729670736963c9688aee251c6fe"><div class="ttname"><a href="namespaceall__vars.html#ae411c729670736963c9688aee251c6fe">all_vars::vvwind</a></div><div class="ttdeci">real(sp), dimension(:), allocatable, target vvwind</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01300">mod_main.F:1300</a></div></div>
<div class="ttc" id="namespaceice__albedo_html"><div class="ttname"><a href="namespaceice__albedo.html">ice_albedo</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__albedo_8F_source.html#l00026">ice_albedo.F:26</a></div></div>
<div class="ttc" id="namespaceice__init_html_a5415eb5796bc1fd1eac438d37fdcd358"><div class="ttname"><a href="namespaceice__init.html#a5415eb5796bc1fd1eac438d37fdcd358">ice_init::init_flux</a></div><div class="ttdeci">subroutine init_flux</div><div class="ttdef"><b>Definition:</b> <a href="ice__init_8F_source.html#l00646">ice_init.F:646</a></div></div>
<div class="ttc" id="namespaceice__work_html_aad897aa7c6c5fc4bc998a5dbaf71baa0"><div class="ttname"><a href="namespaceice__work.html#aad897aa7c6c5fc4bc998a5dbaf71baa0">ice_work::work_l1</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable work_l1</div><div class="ttdef"><b>Definition:</b> <a href="ice__work_8F_source.html#l00050">ice_work.F:50</a></div></div>
<div class="ttc" id="namespaceice__grid_html_a2078ef17c456ac3a3624e575ae494492"><div class="ttname"><a href="namespaceice__grid.html#a2078ef17c456ac3a3624e575ae494492">ice_grid::umask</a></div><div class="ttdeci">logical(kind=log_kind), dimension(:,:), allocatable umask</div><div class="ttdef"><b>Definition:</b> <a href="ice__grid_8F_source.html#l00153">ice_grid.F:153</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a4157035e8b6719ef6a626a12ef6acaf8"><div class="ttname"><a href="namespaceall__vars.html#a4157035e8b6719ef6a626a12ef6acaf8">all_vars::qprec2</a></div><div class="ttdeci">real(sp), dimension(:), allocatable, target qprec2</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01303">mod_main.F:1303</a></div></div>
<div class="ttc" id="namespaceice__itd_html"><div class="ttname"><a href="namespaceice__itd.html">ice_itd</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__itd_8F_source.html#l00037">ice_itd.F:37</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a1791756d6e4e49a3a20fb40985850c0a"><div class="ttname"><a href="namespaceall__vars.html#a1791756d6e4e49a3a20fb40985850c0a">all_vars::n2e3d</a></div><div class="ttdeci">subroutine n2e3d(NVAR, EVAR)</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01499">mod_main.F:1499</a></div></div>
<div class="ttc" id="namespaceice__therm__vertical_html_af4b7c768b6eed0e7f9f89d2ff7d0643a"><div class="ttname"><a href="namespaceice__therm__vertical.html#af4b7c768b6eed0e7f9f89d2ff7d0643a">ice_therm_vertical::rside</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save rside</div><div class="ttdef"><b>Definition:</b> <a href="ice__therm__vertical_8F_source.html#l00074">ice_therm_vertical.F:74</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_aba651c014e5849c5f013553556fbb754"><div class="ttname"><a href="namespaceice__mechred.html#aba651c014e5849c5f013553556fbb754">ice_mechred::asum</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save asum</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00122">ice_mechred.F:122</a></div></div>
<div class="ttc" id="namespaceice__therm__vertical_html_a41018c2d1275b4fee13d1d97c7d32298"><div class="ttname"><a href="namespaceice__therm__vertical.html#a41018c2d1275b4fee13d1d97c7d32298">ice_therm_vertical::thermo_vertical</a></div><div class="ttdeci">subroutine thermo_vertical</div><div class="ttdef"><b>Definition:</b> <a href="ice__therm__vertical_8F_source.html#l00174">ice_therm_vertical.F:174</a></div></div>
<div class="ttc" id="namespacemod__par_html_a7ca332c77f501334fff64fc71f745859"><div class="ttname"><a href="namespacemod__par.html#a7ca332c77f501334fff64fc71f745859">mod_par::bn_loc</a></div><div class="ttdeci">integer, dimension(:), pointer bn_loc</div><div class="ttdef"><b>Definition:</b> <a href="mod__par_8F_source.html#l00068">mod_par.F:68</a></div></div>
<div class="ttc" id="namespaceice__model__size_html_aad5690a90b6f7ad823dba09d293ca892"><div class="ttname"><a href="namespaceice__model__size.html#aad5690a90b6f7ad823dba09d293ca892">ice_model_size::ntilay</a></div><div class="ttdeci">integer(kind=int_kind), parameter ntilay</div><div class="ttdef"><b>Definition:</b> <a href="ice__model__size_8F_source.html#l00038">ice_model_size.F:38</a></div></div>
<div class="ttc" id="namespaceall__vars_html_ae97d24576113fd6d6cbe7a5a32938301"><div class="ttname"><a href="namespaceall__vars.html#ae97d24576113fd6d6cbe7a5a32938301">all_vars::t</a></div><div class="ttdeci">real(sp), dimension(:,:), allocatable, target t</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01387">mod_main.F:1387</a></div></div>
<div class="ttc" id="namespaceice__flux_html"><div class="ttname"><a href="namespaceice__flux.html">ice_flux</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__flux_8F_source.html#l00025">ice_flux.F:25</a></div></div>
<div class="ttc" id="namespaceice__init_html_aafefd572779d7e57a1c62b63ecec3813"><div class="ttname"><a href="namespaceice__init.html#aafefd572779d7e57a1c62b63ecec3813">ice_init::init_state</a></div><div class="ttdeci">subroutine init_state</div><div class="ttdef"><b>Definition:</b> <a href="ice__init_8F_source.html#l00478">ice_init.F:478</a></div></div>
<div class="ttc" id="namespaceice__ocean_html"><div class="ttname"><a href="namespaceice__ocean.html">ice_ocean</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__ocean_8F_source.html#l00028">ice_ocean.F:28</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a2033f4e36f7d6c8309e9074a7d5e6d2d"><div class="ttname"><a href="namespaceall__vars.html#a2033f4e36f7d6c8309e9074a7d5e6d2d">all_vars::wtsurf</a></div><div class="ttdeci">real(sp), dimension(:), allocatable, target wtsurf</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01245">mod_main.F:1245</a></div></div>
<div class="ttc" id="namespacemod__utils_html_a60e94d6abe4ceab6a20f4e569a826bea"><div class="ttname"><a href="namespacemod__utils.html#a60e94d6abe4ceab6a20f4e569a826bea">mod_utils::dbg_sbr</a></div><div class="ttdeci">integer, parameter dbg_sbr</div><div class="ttdef"><b>Definition:</b> <a href="mod__utils_8F_source.html#l00062">mod_utils.F:62</a></div></div>
<div class="ttc" id="namespacemod__ice2d_html"><div class="ttname"><a href="namespacemod__ice2d.html">mod_ice2d</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__ice2d_8F_source.html#l00029">mod_ice2d.F:29</a></div></div>
<div class="ttc" id="namespaceice__grid_html_af435d3d80d4ce3a7ae22bb37fa002f03"><div class="ttname"><a href="namespaceice__grid.html#af435d3d80d4ce3a7ae22bb37fa002f03">ice_grid::tlon</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable tlon</div><div class="ttdef"><b>Definition:</b> <a href="ice__grid_8F_source.html#l00111">ice_grid.F:111</a></div></div>
<div class="ttc" id="namespaceice__domain_html_a9069546ddbdc761fe347991cb8475161"><div class="ttname"><a href="namespaceice__domain.html#a9069546ddbdc761fe347991cb8475161">ice_domain::master_task</a></div><div class="ttdeci">integer(kind=int_kind), save master_task</div><div class="ttdef"><b>Definition:</b> <a href="ice__domain_8F_source.html#l00089">ice_domain.F:89</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a7061ce24690eeffdde5c39c53967a31e"><div class="ttname"><a href="namespaceall__vars.html#a7061ce24690eeffdde5c39c53967a31e">all_vars::inodeq</a></div><div class="ttdeci">integer, dimension(:), allocatable, target inodeq</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01281">mod_main.F:1281</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_a1b1a7c80a1b7f77b554176296ead9de9"><div class="ttname"><a href="namespaceice__mechred.html#a1b1a7c80a1b7f77b554176296ead9de9">ice_mechred::dardg2dt</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:), allocatable, save dardg2dt</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00109">ice_mechred.F:109</a></div></div>
<div class="ttc" id="namespaceall__vars_html_a401dd74516325086c3c3a13bd6cd7d56"><div class="ttname"><a href="namespaceall__vars.html#a401dd74516325086c3c3a13bd6cd7d56">all_vars::isonb</a></div><div class="ttdeci">integer, dimension(:), allocatable, target isonb</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01080">mod_main.F:1080</a></div></div>
<div class="ttc" id="namespaceice__domain_html_a2ebda89f239a49c06b347be85185ccd1"><div class="ttname"><a href="namespaceice__domain.html#a2ebda89f239a49c06b347be85185ccd1">ice_domain::jmt_local</a></div><div class="ttdeci">integer(kind=int_kind) jmt_local</div><div class="ttdef"><b>Definition:</b> <a href="ice__domain_8F_source.html#l00095">ice_domain.F:95</a></div></div>
<div class="ttc" id="namespaceice__therm__vertical_html"><div class="ttname"><a href="namespaceice__therm__vertical.html">ice_therm_vertical</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__therm__vertical_8F_source.html#l00035">ice_therm_vertical.F:35</a></div></div>
<div class="ttc" id="namespaceice__albedo_html_a6c30720dc5655cb2a4e96be48d9477ce"><div class="ttname"><a href="namespaceice__albedo.html#a6c30720dc5655cb2a4e96be48d9477ce">ice_albedo::alvdfn</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:,:), allocatable, save alvdfn</div><div class="ttdef"><b>Definition:</b> <a href="ice__albedo_8F_source.html#l00065">ice_albedo.F:65</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_ae61458b8a88c5235b64bd4db1e35f42b"><div class="ttname"><a href="namespaceice__mechred.html#ae61458b8a88c5235b64bd4db1e35f42b">ice_mechred::init_mechred</a></div><div class="ttdeci">subroutine init_mechred</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00162">ice_mechred.F:162</a></div></div>
<div class="ttc" id="namespaceice__itd_html_af934be7228f44bbd21e488aed8e431b3"><div class="ttname"><a href="namespaceice__itd.html#af934be7228f44bbd21e488aed8e431b3">ice_itd::aggregate</a></div><div class="ttdeci">subroutine aggregate</div><div class="ttdef"><b>Definition:</b> <a href="ice__itd_8F_source.html#l00226">ice_itd.F:226</a></div></div>
<div class="ttc" id="namespaceice__model__size_html"><div class="ttname"><a href="namespaceice__model__size.html">ice_model_size</a></div><div class="ttdef"><b>Definition:</b> <a href="ice__model__size_8F_source.html#l00024">ice_model_size.F:24</a></div></div>
<div class="ttc" id="namespaceice__grid_html_a667faa0f8cb8b48d875aad2fff969008"><div class="ttname"><a href="namespaceice__grid.html#a667faa0f8cb8b48d875aad2fff969008">ice_grid::tmask</a></div><div class="ttdeci">logical(kind=log_kind), dimension(:,:), allocatable tmask</div><div class="ttdef"><b>Definition:</b> <a href="ice__grid_8F_source.html#l00153">ice_grid.F:153</a></div></div>
<div class="ttc" id="namespaceall__vars_html_aa0eab3881f061cf17524342858a10a6d"><div class="ttname"><a href="namespaceall__vars.html#aa0eab3881f061cf17524342858a10a6d">all_vars::uuwind</a></div><div class="ttdeci">real(sp), dimension(:), allocatable, target uuwind</div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01299">mod_main.F:1299</a></div></div>
<div class="ttc" id="namespacebcs_html"><div class="ttname"><a href="namespacebcs.html">bcs</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__main_8F_source.html#l01978">mod_main.F:1978</a></div></div>
<div class="ttc" id="namespaceice__init_html_a8aeb5361cfea01402260b8b2727a2f4a"><div class="ttname"><a href="namespaceice__init.html#a8aeb5361cfea01402260b8b2727a2f4a">ice_init::input_data</a></div><div class="ttdeci">subroutine input_data</div><div class="ttdef"><b>Definition:</b> <a href="ice__init_8F_source.html#l00059">ice_init.F:59</a></div></div>
<div class="ttc" id="namespaceice__itd_html_a5c431bd25eb67ee3bc2efd90b29450d7"><div class="ttname"><a href="namespaceice__itd.html#a5c431bd25eb67ee3bc2efd90b29450d7">ice_itd::zap_small_areas</a></div><div class="ttdeci">subroutine zap_small_areas</div><div class="ttdef"><b>Definition:</b> <a href="ice__itd_8F_source.html#l01305">ice_itd.F:1305</a></div></div>
<div class="ttc" id="namespacemod__utils_html_a4daeef481645d2d17b535a634a45701c"><div class="ttname"><a href="namespacemod__utils.html#a4daeef481645d2d17b535a634a45701c">mod_utils::dbg_log</a></div><div class="ttdeci">integer, parameter dbg_log</div><div class="ttdef"><b>Definition:</b> <a href="mod__utils_8F_source.html#l00058">mod_utils.F:58</a></div></div>
<div class="ttc" id="namespaceice__mechred_html_a54779eaa3c2052bdd1525ef96a5be9d4"><div class="ttname"><a href="namespaceice__mechred.html#a54779eaa3c2052bdd1525ef96a5be9d4">ice_mechred::hrmax</a></div><div class="ttdeci">real(kind=dbl_kind), dimension(:,:,:), allocatable, save hrmax</div><div class="ttdef"><b>Definition:</b> <a href="ice__mechred_8F_source.html#l00132">ice_mechred.F:132</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
